{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# 論文"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {
    "scrolled": true
   },
   "outputs": [],
   "source": [
    "from sklearn import preprocessing\n",
    "import time\n",
    "import numpy as np\n",
    "\n",
    "import matplotlib.pyplot as plt\n",
    "import tensorflow.contrib.learn as skflow\n",
    "import pandas as pd\n",
    "import os\n",
    "import numpy as np\n",
    "from sklearn import metrics\n",
    "from scipy.stats import zscore\n",
    "\n",
    "\n",
    "pd.options.display.max_columns = None # show all column\n",
    "\n",
    "# Encode text values to dummy variables(i.e. [1,0,0],[0,1,0],[0,0,1] for red,green,blue)\n",
    "# One-hot encoding\n",
    "\n",
    "def encode_text_dummy(df, name, temp_text):\n",
    "    dummies = pd.get_dummies(df[name])\n",
    "    for x in dummies.columns:\n",
    "        dummy_name = \"{}-{}\".format(name, x)\n",
    "        df[dummy_name] = dummies[x]\n",
    "    df.drop(name, axis=1, inplace=True)\n",
    "\"\"\"\n",
    "def encode_text_dummy(df, name, temp_text):\n",
    "    le = preprocessing.LabelEncoder()\n",
    "    #df[name] = le.fit_transform(df[name])\n",
    "    temp_text[name] = le.fit_transform(df[name])\n",
    "    df.pop(name)\n",
    "    \n",
    "    return le.classes_\n",
    "\"\"\"\n",
    "\n",
    "\"\"\"\n",
    "def encode_text_dummy(df, name):\n",
    "    dummies = pd.get_dummies(df[name])\n",
    "    i = 0 # 更換df內資料須計算的counter\n",
    "    n = 1 # 根據dummies.columns  如: icmp=1, udp=2, tcp=3\n",
    "    for x in dummies.columns:\n",
    "        for y in df[name]:\n",
    "            i = i+1\n",
    "            if x == y:\n",
    "                #df[name] = i\n",
    "                df.loc[i-1, name]  = n\n",
    "        n = n + 1\n",
    "        \n",
    "    df.drop(name, axis=1, inplace=True)\n",
    "\"\"\"\n",
    "\n",
    "# Encode a numeric column as zscores\n",
    "def encode_numeric_maxmin(df, name, mean=None, sd=None, max=None, min=None):\n",
    "    if mean is None:\n",
    "        mean = df[name].mean()\n",
    "\n",
    "    if sd is None:\n",
    "        sd = df[name].std()\n",
    "        \n",
    "    if max is None:\n",
    "        max = df[name].max()\n",
    "        \n",
    "    if min is None:\n",
    "        min = df[name].min()    \n",
    "\n",
    "\n",
    "    df[name] = (df[name] - min) / (max - min)\n",
    "\n",
    "    \n",
    "# Encode a numeric column as zscores\n",
    "def encode_numeric_zscore(df, name, mean=None, sd=None, max=None, min=None):\n",
    "    if mean is None:\n",
    "        mean = df[name].mean()\n",
    "\n",
    "    if sd is None:\n",
    "        sd = df[name].std()\n",
    "        \n",
    "    if max is None:\n",
    "        max = df[name].max()\n",
    "        \n",
    "    if min is None:\n",
    "        min = df[name].min()    \n",
    "\n",
    "    df[name] = (df[name] - mean) / sd\n",
    "    #df[name] = (df[name] - min) / (max - min)\n",
    "\n",
    "# Encode text values to indexes(i.e. [1],[2],[3] for red,green,blue).\n",
    "def encode_text_index(df, name):\n",
    "    #le = preprocessing.LabelEncoder()\n",
    "    #df[name] = le.fit_transform(df[name])\n",
    "    #return le.classes_\n",
    "    \n",
    "    #df[name][df[name] == 'normal'] = 0\n",
    "    #df[name][df[name] != 'normal'] = 1\n",
    "    \n",
    "    df[name][df[name] == 'normal'] = 0\n",
    "    df[name][df[name] != 0] = 1\n",
    "    \"\"\"\n",
    "    i = 0\n",
    "    for x in df[name]:\n",
    "        i += 1\n",
    "        if x == 'normal':\n",
    "            df.loc[i-1, 'outcome']  = 0\n",
    "        elif x == 'back' or x == 'land' or x == 'neptune' or x == 'pod' or x == 'smurf' or x == 'teardrop': # dos\n",
    "            df.loc[i-1, 'outcome']  = 1\n",
    "        elif x == 'ipsweep' or x == 'nmap' or x == 'portsweep' or x == 'satan': # probe\n",
    "            df.loc[i-1, 'outcome']  = 1\n",
    "        elif x == 'buffer_overflow' or x == 'loadmodule' or x == 'perl' or x == 'rootkit': # u2r\n",
    "            df.loc[i-1, 'outcome']  = 1\n",
    "        elif x == 'ftp_write' or x == 'guess_passwd' or x == 'imap' or x == 'multihop' or x == 'phf' or x == 'spy' or x == 'warezclient' or x == 'warezmaster': #r2l\n",
    "            df.loc[i-1, 'outcome']  = 1\n",
    "        else:\n",
    "            df.loc[i-1, 'outcome']  = 6\n",
    "    \"\"\"         \n",
    "    \n",
    "def encode_text_index1(df, name):\n",
    "    #le = preprocessing.LabelEncoder()\n",
    "    #df[name] = le.fit_transform(df[name])\n",
    "    #return le.classes_\n",
    "    \n",
    "    #df[name][df[name] == 'normal'] = 0\n",
    "    #df[name][df[name] != 'normal'] = 1\n",
    "    \n",
    "    #df[name][df[name] == 'normal'] = 0\n",
    "    #df[name][df[name] != 0] = 1\n",
    "    \n",
    "    df.loc[(df[name] == 'normal'), name] = 0\n",
    "    \n",
    "    \n",
    "    df.loc[(df[name] == 'back') \n",
    "        | (df[name] == 'land') \n",
    "        | (df[name] == 'neptune') \n",
    "        | (df[name] == 'pod') \n",
    "        | (df[name] == 'smurf') \n",
    "        | (df[name] == 'teardrop')\n",
    "        | (df[name] == 'apache2')\n",
    "        | (df[name] == 'mailbomb')\n",
    "        | (df[name] == 'processtable')\n",
    "        | (df[name] == 'udpstorm'), name] = 1\n",
    "    \n",
    "    \n",
    "    \n",
    "    df.loc[(df[name] == 'ipsweep') \n",
    "           | (df[name] == 'nmap')\n",
    "           | (df[name] == 'portsweep') \n",
    "           | (df[name] == 'satan')\n",
    "           | (df[name] == 'mscan') \n",
    "           | (df[name] == 'saint'), name] = 2\n",
    "\n",
    "    \n",
    "    df.loc[(df[name] == 'buffer_overflow') \n",
    "           | (df[name] == 'loadmodule')\n",
    "           | (df[name] == 'perl') \n",
    "           | (df[name] == 'rootkit')\n",
    "           | (df[name] == 'httptunnel') \n",
    "           | (df[name] == 'ps')\n",
    "           | (df[name] == 'sqlattack') \n",
    "           | (df[name] == 'xterm'), name] = 3\n",
    "\n",
    "        \n",
    "    df.loc[(df[name] == 'ftp_write') \n",
    "           | (df[name] == 'guess_passwd')\n",
    "           | (df[name] == 'imap') \n",
    "           | (df[name] == 'multihop')\n",
    "           | (df[name] == 'phf') \n",
    "           | (df[name] == 'spy')\n",
    "           | (df[name] == 'warezclient') \n",
    "           | (df[name] == 'warezmaster')\n",
    "           | (df[name] == 'sendmail')\n",
    "           | (df[name] == 'named') \n",
    "           | (df[name] == 'snmpgetattack')\n",
    "           | (df[name] == 'snmpguess') \n",
    "           | (df[name] == 'xlock')\n",
    "           | (df[name] == 'xsnoop') \n",
    "           | (df[name] == 'worm'), name] = 4\n",
    "\n",
    "\n",
    "    \n",
    "    \"\"\"\n",
    "    i = 0\n",
    "    for x in df[name]:\n",
    "        i += 1\n",
    "        if x == 'normal':\n",
    "            df.loc[i-1, 'outcome']  = 0\n",
    "        elif x == 'back' or x == 'land' or x == 'neptune' or x == 'pod' or x == 'smurf' or x == 'teardrop': # dos\n",
    "            df.loc[i-1, 'outcome']  = 1\n",
    "        elif x == 'ipsweep' or x == 'nmap' or x == 'portsweep' or x == 'satan': # probe\n",
    "            df.loc[i-1, 'outcome']  = 2\n",
    "        elif x == 'buffer_overflow' or x == 'loadmodule' or x == 'perl' or x == 'rootkit': # u2r\n",
    "            df.loc[i-1, 'outcome']  = 3\n",
    "        elif x == 'ftp_write' or x == 'guess_passwd' or x == 'imap' or x == 'multihop' or x == 'phf' or x == 'spy' or x == 'warezclient' or x == 'warezmaster': #r2l\n",
    "            df.loc[i-1, 'outcome']  = 4\n",
    "       # else:\n",
    "       #    df.loc[i-1, 'outcome']  = 6\n",
    "                \n",
    "    \"\"\"\n",
    "#i = 0\n",
    "#for x in df['outcome']:\n",
    "#    i += 1\n",
    "#    if x == 'normal':\n",
    "#        df.loc[i-1, 'outcome']  = 0\n",
    "\n",
    "def merge_sparse_feature(df):\n",
    "    df.loc[(df['service'] == 'ntp_u')\n",
    "     | (df['service'] == 'urh_i')\n",
    "     | (df['service'] == 'tftp_u')\n",
    "    | (df['service'] == 'red_i')\n",
    "    , 'service'] = 'normal_service_group'\n",
    "\n",
    "    df.loc[(df['service'] == 'pm_dump')\n",
    "     | (df['service'] == 'http_2784')\n",
    "     | (df['service'] == 'harvest')\n",
    "     | (df['service'] == 'aol')\n",
    "     | (df['service'] == 'http_8001')\n",
    "    , 'service'] = 'satan_service_group'\n",
    "    return df\n",
    "\n",
    "def flag_feature_cluster(df):\n",
    "    df.loc[(df['flag'] == 'S0') | (df['flag'] == 'REJ'), 'flag'] = 'FG1'\n",
    "    df.loc[(df['flag'] == 'S1') | (df['flag'] == 'SF') | (df['flag'] == 'OTH'), 'flag'] = 'FG2'\n",
    "    df.loc[(df['flag'] == 'S2') | (df['flag'] == 'RSTO'), 'flag'] = 'FG3'\n",
    "    df.loc[(df['flag'] == 'S3') | (df['flag'] == 'RSTR'), 'flag'] = 'FG4'\n",
    "    df.loc[(df['flag'] == 'RSTOS0') | (df['flag'] == 'SH'), 'flag'] = 'FG5'\n",
    "    df.loc[(df['flag'] == 'RSTRH') | (df['flag'] == 'SHR'), 'flag'] = 'FG6'\n",
    "    \n",
    "    return df\n",
    "\n",
    "def service_feature_cluster(df):\n",
    "    df.loc[(df['service'] == 'telnet') | (df['service'] == 'ssh'), 'service'] = 'SG1'\n",
    "    df.loc[(df['service'] == 'ftp') | (df['service'] == 'tftp') | (df['service'] == 'ftp_data'), 'service'] = 'SG2'\n",
    "    df.loc[(df['service'] == 'smtp') | (df['service'] == 'imap4'), 'service'] = 'SG3'\n",
    "    df.loc[(df['service'] == 'http') | (df['service'] == 'http_443'), 'service'] = 'SG4'\n",
    "    df.loc[(df['service'] == 'systat') | (df['service'] == 'netstat') | (df['service'] == 'finger'), 'service'] = 'SG5'\n",
    "    df.loc[(df['service'] == 'hostnames') | (df['service'] == 'domain') | (df['service'] == 'domain_u'), 'service'] = 'SG6'\n",
    "    df.loc[(df['service'] == 'eco_i') | (df['service'] == 'urp_i') | (df['service'] == 'ecr_i') | \n",
    "       (df['service'] == 'tim_i') | (df['service'] == 'red_i') | (df['service'] == 'urh_i'), 'service'] = 'SG7'\n",
    "    \n",
    "    df.loc[(df['service'] == 'private'), 'service'] = 'SG8'\n",
    "    df.loc[(df['service'] != 'SG1') & (df['service'] != 'SG2') & (df['service'] != 'SG3') &\n",
    "       (df['service'] != 'SG4') & (df['service'] != 'SG5') & (df['service'] != 'SG6') & \n",
    "       (df['service'] != 'SG7'), 'service'] = 'SG8'\n",
    "\n",
    "    \n",
    "    return df"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## 載入 NSL-KDD 99"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {},
   "outputs": [],
   "source": [
    "path = \"./NSL_KDD-master/\"\n",
    "pd.options.display.max_columns = None # show all column\n",
    "\n",
    "filename_read = os.path.join(path,\"KDDTrain+.txt\")\n",
    "#filename_read = os.path.join(path,\"KDDTrain+_20Percent.txt\")\n",
    "\n",
    "filename_read\n",
    "df = pd.read_csv(filename_read, header=None)\n",
    "df.dropna(inplace=True,axis=1) # For now, just drop NA's (rows with missing values)\n",
    "df.columns = [\n",
    "    'duration','protocol_type','service','flag','src_bytes','dst_bytes','land','wrong_fragment','urgent','hot','num_failed_logins',\n",
    "    'logged_in','num_compromised','root_shell','su_attempted','num_root','num_file_creations','num_shells','num_access_files',\n",
    "    'num_outbound_cmds','is_host_login','is_guest_login','count','srv_count','serror_rate','srv_serror_rate','rerror_rate',\n",
    "    'srv_rerror_rate','same_srv_rate','diff_srv_rate','srv_diff_host_rate','dst_host_count','dst_host_srv_count',\n",
    "    'dst_host_same_srv_rate','dst_host_diff_srv_rate','dst_host_same_src_port_rate','dst_host_srv_diff_host_rate',\n",
    "    'dst_host_serror_rate','dst_host_srv_serror_rate','dst_host_rerror_rate','dst_host_srv_rerror_rate',\n",
    "    'outcome','attack'\n",
    "]\n",
    "from sklearn.utils import shuffle\n",
    "#df = shuffle(df)\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## 離散特徵預先人工分類"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>duration</th>\n",
       "      <th>protocol_type</th>\n",
       "      <th>service</th>\n",
       "      <th>flag</th>\n",
       "      <th>src_bytes</th>\n",
       "      <th>dst_bytes</th>\n",
       "      <th>land</th>\n",
       "      <th>wrong_fragment</th>\n",
       "      <th>urgent</th>\n",
       "      <th>hot</th>\n",
       "      <th>num_failed_logins</th>\n",
       "      <th>logged_in</th>\n",
       "      <th>num_compromised</th>\n",
       "      <th>root_shell</th>\n",
       "      <th>su_attempted</th>\n",
       "      <th>num_root</th>\n",
       "      <th>num_file_creations</th>\n",
       "      <th>num_shells</th>\n",
       "      <th>num_access_files</th>\n",
       "      <th>num_outbound_cmds</th>\n",
       "      <th>is_host_login</th>\n",
       "      <th>is_guest_login</th>\n",
       "      <th>count</th>\n",
       "      <th>srv_count</th>\n",
       "      <th>serror_rate</th>\n",
       "      <th>srv_serror_rate</th>\n",
       "      <th>rerror_rate</th>\n",
       "      <th>srv_rerror_rate</th>\n",
       "      <th>same_srv_rate</th>\n",
       "      <th>diff_srv_rate</th>\n",
       "      <th>srv_diff_host_rate</th>\n",
       "      <th>dst_host_count</th>\n",
       "      <th>dst_host_srv_count</th>\n",
       "      <th>dst_host_same_srv_rate</th>\n",
       "      <th>dst_host_diff_srv_rate</th>\n",
       "      <th>dst_host_same_src_port_rate</th>\n",
       "      <th>dst_host_srv_diff_host_rate</th>\n",
       "      <th>dst_host_serror_rate</th>\n",
       "      <th>dst_host_srv_serror_rate</th>\n",
       "      <th>dst_host_rerror_rate</th>\n",
       "      <th>dst_host_srv_rerror_rate</th>\n",
       "      <th>outcome</th>\n",
       "      <th>attack</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>0</td>\n",
       "      <td>tcp</td>\n",
       "      <td>SG2</td>\n",
       "      <td>FG2</td>\n",
       "      <td>491</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>1.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>150</td>\n",
       "      <td>25</td>\n",
       "      <td>0.17</td>\n",
       "      <td>0.03</td>\n",
       "      <td>0.17</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.05</td>\n",
       "      <td>0.00</td>\n",
       "      <td>normal</td>\n",
       "      <td>20</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>0</td>\n",
       "      <td>udp</td>\n",
       "      <td>SG8</td>\n",
       "      <td>FG2</td>\n",
       "      <td>146</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>13</td>\n",
       "      <td>1</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.08</td>\n",
       "      <td>0.15</td>\n",
       "      <td>0.00</td>\n",
       "      <td>255</td>\n",
       "      <td>1</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.60</td>\n",
       "      <td>0.88</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>normal</td>\n",
       "      <td>15</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>0</td>\n",
       "      <td>tcp</td>\n",
       "      <td>SG8</td>\n",
       "      <td>FG1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>123</td>\n",
       "      <td>6</td>\n",
       "      <td>1.00</td>\n",
       "      <td>1.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.05</td>\n",
       "      <td>0.07</td>\n",
       "      <td>0.00</td>\n",
       "      <td>255</td>\n",
       "      <td>26</td>\n",
       "      <td>0.10</td>\n",
       "      <td>0.05</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>1.00</td>\n",
       "      <td>1.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>neptune</td>\n",
       "      <td>19</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>0</td>\n",
       "      <td>tcp</td>\n",
       "      <td>SG4</td>\n",
       "      <td>FG2</td>\n",
       "      <td>232</td>\n",
       "      <td>8153</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>5</td>\n",
       "      <td>5</td>\n",
       "      <td>0.20</td>\n",
       "      <td>0.20</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>1.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>30</td>\n",
       "      <td>255</td>\n",
       "      <td>1.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.03</td>\n",
       "      <td>0.04</td>\n",
       "      <td>0.03</td>\n",
       "      <td>0.01</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.01</td>\n",
       "      <td>normal</td>\n",
       "      <td>21</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>0</td>\n",
       "      <td>tcp</td>\n",
       "      <td>SG4</td>\n",
       "      <td>FG2</td>\n",
       "      <td>199</td>\n",
       "      <td>420</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>30</td>\n",
       "      <td>32</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>1.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.09</td>\n",
       "      <td>255</td>\n",
       "      <td>255</td>\n",
       "      <td>1.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>normal</td>\n",
       "      <td>21</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>0</td>\n",
       "      <td>tcp</td>\n",
       "      <td>SG8</td>\n",
       "      <td>FG1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>121</td>\n",
       "      <td>19</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>1.00</td>\n",
       "      <td>1.00</td>\n",
       "      <td>0.16</td>\n",
       "      <td>0.06</td>\n",
       "      <td>0.00</td>\n",
       "      <td>255</td>\n",
       "      <td>19</td>\n",
       "      <td>0.07</td>\n",
       "      <td>0.07</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>1.00</td>\n",
       "      <td>1.00</td>\n",
       "      <td>neptune</td>\n",
       "      <td>21</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>0</td>\n",
       "      <td>tcp</td>\n",
       "      <td>SG8</td>\n",
       "      <td>FG1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>166</td>\n",
       "      <td>9</td>\n",
       "      <td>1.00</td>\n",
       "      <td>1.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.05</td>\n",
       "      <td>0.06</td>\n",
       "      <td>0.00</td>\n",
       "      <td>255</td>\n",
       "      <td>9</td>\n",
       "      <td>0.04</td>\n",
       "      <td>0.05</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>1.00</td>\n",
       "      <td>1.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>neptune</td>\n",
       "      <td>21</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>0</td>\n",
       "      <td>tcp</td>\n",
       "      <td>SG8</td>\n",
       "      <td>FG1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>117</td>\n",
       "      <td>16</td>\n",
       "      <td>1.00</td>\n",
       "      <td>1.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.14</td>\n",
       "      <td>0.06</td>\n",
       "      <td>0.00</td>\n",
       "      <td>255</td>\n",
       "      <td>15</td>\n",
       "      <td>0.06</td>\n",
       "      <td>0.07</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>1.00</td>\n",
       "      <td>1.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>neptune</td>\n",
       "      <td>21</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>0</td>\n",
       "      <td>tcp</td>\n",
       "      <td>SG8</td>\n",
       "      <td>FG1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>270</td>\n",
       "      <td>23</td>\n",
       "      <td>1.00</td>\n",
       "      <td>1.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.09</td>\n",
       "      <td>0.05</td>\n",
       "      <td>0.00</td>\n",
       "      <td>255</td>\n",
       "      <td>23</td>\n",
       "      <td>0.09</td>\n",
       "      <td>0.05</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>1.00</td>\n",
       "      <td>1.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>neptune</td>\n",
       "      <td>21</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>0</td>\n",
       "      <td>tcp</td>\n",
       "      <td>SG8</td>\n",
       "      <td>FG1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>133</td>\n",
       "      <td>8</td>\n",
       "      <td>1.00</td>\n",
       "      <td>1.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.06</td>\n",
       "      <td>0.06</td>\n",
       "      <td>0.00</td>\n",
       "      <td>255</td>\n",
       "      <td>13</td>\n",
       "      <td>0.05</td>\n",
       "      <td>0.06</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>1.00</td>\n",
       "      <td>1.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>neptune</td>\n",
       "      <td>21</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10</th>\n",
       "      <td>0</td>\n",
       "      <td>tcp</td>\n",
       "      <td>SG8</td>\n",
       "      <td>FG1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>205</td>\n",
       "      <td>12</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>1.00</td>\n",
       "      <td>1.00</td>\n",
       "      <td>0.06</td>\n",
       "      <td>0.06</td>\n",
       "      <td>0.00</td>\n",
       "      <td>255</td>\n",
       "      <td>12</td>\n",
       "      <td>0.05</td>\n",
       "      <td>0.07</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>1.00</td>\n",
       "      <td>1.00</td>\n",
       "      <td>neptune</td>\n",
       "      <td>21</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11</th>\n",
       "      <td>0</td>\n",
       "      <td>tcp</td>\n",
       "      <td>SG8</td>\n",
       "      <td>FG1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>199</td>\n",
       "      <td>3</td>\n",
       "      <td>1.00</td>\n",
       "      <td>1.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.02</td>\n",
       "      <td>0.06</td>\n",
       "      <td>0.00</td>\n",
       "      <td>255</td>\n",
       "      <td>13</td>\n",
       "      <td>0.05</td>\n",
       "      <td>0.07</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>1.00</td>\n",
       "      <td>1.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>neptune</td>\n",
       "      <td>21</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>0</td>\n",
       "      <td>tcp</td>\n",
       "      <td>SG4</td>\n",
       "      <td>FG2</td>\n",
       "      <td>287</td>\n",
       "      <td>2251</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>3</td>\n",
       "      <td>7</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>1.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.43</td>\n",
       "      <td>8</td>\n",
       "      <td>219</td>\n",
       "      <td>1.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.12</td>\n",
       "      <td>0.03</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>normal</td>\n",
       "      <td>21</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13</th>\n",
       "      <td>0</td>\n",
       "      <td>tcp</td>\n",
       "      <td>SG2</td>\n",
       "      <td>FG2</td>\n",
       "      <td>334</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>1.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>2</td>\n",
       "      <td>20</td>\n",
       "      <td>1.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>1.00</td>\n",
       "      <td>0.20</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>warezclient</td>\n",
       "      <td>15</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14</th>\n",
       "      <td>0</td>\n",
       "      <td>tcp</td>\n",
       "      <td>SG8</td>\n",
       "      <td>FG1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>233</td>\n",
       "      <td>1</td>\n",
       "      <td>1.00</td>\n",
       "      <td>1.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.06</td>\n",
       "      <td>0.00</td>\n",
       "      <td>255</td>\n",
       "      <td>1</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.07</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>1.00</td>\n",
       "      <td>1.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>neptune</td>\n",
       "      <td>19</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15</th>\n",
       "      <td>0</td>\n",
       "      <td>tcp</td>\n",
       "      <td>SG8</td>\n",
       "      <td>FG1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>96</td>\n",
       "      <td>16</td>\n",
       "      <td>1.00</td>\n",
       "      <td>1.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.17</td>\n",
       "      <td>0.05</td>\n",
       "      <td>0.00</td>\n",
       "      <td>255</td>\n",
       "      <td>2</td>\n",
       "      <td>0.01</td>\n",
       "      <td>0.06</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>1.00</td>\n",
       "      <td>1.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>neptune</td>\n",
       "      <td>18</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16</th>\n",
       "      <td>0</td>\n",
       "      <td>tcp</td>\n",
       "      <td>SG4</td>\n",
       "      <td>FG2</td>\n",
       "      <td>300</td>\n",
       "      <td>13788</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>8</td>\n",
       "      <td>9</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.11</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>1.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.22</td>\n",
       "      <td>91</td>\n",
       "      <td>255</td>\n",
       "      <td>1.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.01</td>\n",
       "      <td>0.02</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>normal</td>\n",
       "      <td>21</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17</th>\n",
       "      <td>0</td>\n",
       "      <td>icmp</td>\n",
       "      <td>SG7</td>\n",
       "      <td>FG2</td>\n",
       "      <td>18</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>1.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>1</td>\n",
       "      <td>16</td>\n",
       "      <td>1.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>1.00</td>\n",
       "      <td>1.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>ipsweep</td>\n",
       "      <td>18</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>18</th>\n",
       "      <td>0</td>\n",
       "      <td>tcp</td>\n",
       "      <td>SG4</td>\n",
       "      <td>FG2</td>\n",
       "      <td>233</td>\n",
       "      <td>616</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>3</td>\n",
       "      <td>3</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>1.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>66</td>\n",
       "      <td>255</td>\n",
       "      <td>1.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.02</td>\n",
       "      <td>0.03</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.02</td>\n",
       "      <td>0.00</td>\n",
       "      <td>normal</td>\n",
       "      <td>21</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19</th>\n",
       "      <td>0</td>\n",
       "      <td>tcp</td>\n",
       "      <td>SG4</td>\n",
       "      <td>FG2</td>\n",
       "      <td>343</td>\n",
       "      <td>1178</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>9</td>\n",
       "      <td>10</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>1.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.20</td>\n",
       "      <td>157</td>\n",
       "      <td>255</td>\n",
       "      <td>1.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.01</td>\n",
       "      <td>0.04</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>normal</td>\n",
       "      <td>21</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>20</th>\n",
       "      <td>0</td>\n",
       "      <td>tcp</td>\n",
       "      <td>SG8</td>\n",
       "      <td>FG1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>223</td>\n",
       "      <td>23</td>\n",
       "      <td>1.00</td>\n",
       "      <td>1.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.10</td>\n",
       "      <td>0.05</td>\n",
       "      <td>0.00</td>\n",
       "      <td>255</td>\n",
       "      <td>23</td>\n",
       "      <td>0.09</td>\n",
       "      <td>0.05</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>1.00</td>\n",
       "      <td>1.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>neptune</td>\n",
       "      <td>18</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>21</th>\n",
       "      <td>0</td>\n",
       "      <td>tcp</td>\n",
       "      <td>SG8</td>\n",
       "      <td>FG1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>280</td>\n",
       "      <td>17</td>\n",
       "      <td>1.00</td>\n",
       "      <td>1.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.06</td>\n",
       "      <td>0.05</td>\n",
       "      <td>0.00</td>\n",
       "      <td>238</td>\n",
       "      <td>17</td>\n",
       "      <td>0.07</td>\n",
       "      <td>0.06</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.99</td>\n",
       "      <td>1.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>neptune</td>\n",
       "      <td>18</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>22</th>\n",
       "      <td>0</td>\n",
       "      <td>tcp</td>\n",
       "      <td>SG4</td>\n",
       "      <td>FG2</td>\n",
       "      <td>253</td>\n",
       "      <td>11905</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>8</td>\n",
       "      <td>10</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>1.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.20</td>\n",
       "      <td>87</td>\n",
       "      <td>255</td>\n",
       "      <td>1.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.01</td>\n",
       "      <td>0.02</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>normal</td>\n",
       "      <td>21</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>23</th>\n",
       "      <td>5607</td>\n",
       "      <td>udp</td>\n",
       "      <td>SG8</td>\n",
       "      <td>FG2</td>\n",
       "      <td>147</td>\n",
       "      <td>105</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>1.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>255</td>\n",
       "      <td>1</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.85</td>\n",
       "      <td>1.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>normal</td>\n",
       "      <td>21</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>24</th>\n",
       "      <td>0</td>\n",
       "      <td>tcp</td>\n",
       "      <td>SG8</td>\n",
       "      <td>FG1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>248</td>\n",
       "      <td>2</td>\n",
       "      <td>1.00</td>\n",
       "      <td>1.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.01</td>\n",
       "      <td>0.06</td>\n",
       "      <td>0.00</td>\n",
       "      <td>255</td>\n",
       "      <td>2</td>\n",
       "      <td>0.01</td>\n",
       "      <td>0.06</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>1.00</td>\n",
       "      <td>1.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>neptune</td>\n",
       "      <td>19</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>25</th>\n",
       "      <td>507</td>\n",
       "      <td>tcp</td>\n",
       "      <td>SG1</td>\n",
       "      <td>FG2</td>\n",
       "      <td>437</td>\n",
       "      <td>14421</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>3</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>1.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>255</td>\n",
       "      <td>25</td>\n",
       "      <td>0.10</td>\n",
       "      <td>0.05</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.53</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.02</td>\n",
       "      <td>0.16</td>\n",
       "      <td>normal</td>\n",
       "      <td>20</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>26</th>\n",
       "      <td>0</td>\n",
       "      <td>tcp</td>\n",
       "      <td>SG8</td>\n",
       "      <td>FG1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>279</td>\n",
       "      <td>7</td>\n",
       "      <td>1.00</td>\n",
       "      <td>1.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.03</td>\n",
       "      <td>0.06</td>\n",
       "      <td>0.00</td>\n",
       "      <td>255</td>\n",
       "      <td>13</td>\n",
       "      <td>0.05</td>\n",
       "      <td>0.07</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>1.00</td>\n",
       "      <td>1.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>neptune</td>\n",
       "      <td>21</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>27</th>\n",
       "      <td>0</td>\n",
       "      <td>tcp</td>\n",
       "      <td>SG4</td>\n",
       "      <td>FG2</td>\n",
       "      <td>227</td>\n",
       "      <td>6588</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>5</td>\n",
       "      <td>22</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>1.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.18</td>\n",
       "      <td>43</td>\n",
       "      <td>255</td>\n",
       "      <td>1.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.02</td>\n",
       "      <td>0.14</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.56</td>\n",
       "      <td>0.57</td>\n",
       "      <td>normal</td>\n",
       "      <td>21</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>28</th>\n",
       "      <td>0</td>\n",
       "      <td>tcp</td>\n",
       "      <td>SG4</td>\n",
       "      <td>FG2</td>\n",
       "      <td>215</td>\n",
       "      <td>10499</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>14</td>\n",
       "      <td>14</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>1.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>255</td>\n",
       "      <td>255</td>\n",
       "      <td>1.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>normal</td>\n",
       "      <td>21</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>29</th>\n",
       "      <td>0</td>\n",
       "      <td>tcp</td>\n",
       "      <td>SG4</td>\n",
       "      <td>FG2</td>\n",
       "      <td>241</td>\n",
       "      <td>1400</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>33</td>\n",
       "      <td>33</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.03</td>\n",
       "      <td>0.03</td>\n",
       "      <td>1.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>255</td>\n",
       "      <td>255</td>\n",
       "      <td>1.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>normal</td>\n",
       "      <td>21</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>125943</th>\n",
       "      <td>0</td>\n",
       "      <td>tcp</td>\n",
       "      <td>SG2</td>\n",
       "      <td>FG2</td>\n",
       "      <td>491</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>5</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>1.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>6</td>\n",
       "      <td>65</td>\n",
       "      <td>0.33</td>\n",
       "      <td>0.33</td>\n",
       "      <td>0.33</td>\n",
       "      <td>0.03</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>normal</td>\n",
       "      <td>21</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>125944</th>\n",
       "      <td>1</td>\n",
       "      <td>tcp</td>\n",
       "      <td>SG3</td>\n",
       "      <td>FG2</td>\n",
       "      <td>2049</td>\n",
       "      <td>362</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>4</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>1.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>1.00</td>\n",
       "      <td>95</td>\n",
       "      <td>87</td>\n",
       "      <td>0.92</td>\n",
       "      <td>0.02</td>\n",
       "      <td>0.01</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>normal</td>\n",
       "      <td>21</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>125945</th>\n",
       "      <td>0</td>\n",
       "      <td>tcp</td>\n",
       "      <td>SG4</td>\n",
       "      <td>FG2</td>\n",
       "      <td>247</td>\n",
       "      <td>799</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>4</td>\n",
       "      <td>4</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>1.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>192</td>\n",
       "      <td>255</td>\n",
       "      <td>1.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.01</td>\n",
       "      <td>0.02</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>normal</td>\n",
       "      <td>21</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>125946</th>\n",
       "      <td>0</td>\n",
       "      <td>tcp</td>\n",
       "      <td>SG5</td>\n",
       "      <td>FG1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>288</td>\n",
       "      <td>13</td>\n",
       "      <td>1.00</td>\n",
       "      <td>1.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.05</td>\n",
       "      <td>0.06</td>\n",
       "      <td>0.00</td>\n",
       "      <td>255</td>\n",
       "      <td>10</td>\n",
       "      <td>0.04</td>\n",
       "      <td>0.07</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>1.00</td>\n",
       "      <td>1.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>neptune</td>\n",
       "      <td>20</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>125947</th>\n",
       "      <td>0</td>\n",
       "      <td>icmp</td>\n",
       "      <td>SG7</td>\n",
       "      <td>FG2</td>\n",
       "      <td>18</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>1.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>2</td>\n",
       "      <td>218</td>\n",
       "      <td>1.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>1.00</td>\n",
       "      <td>0.25</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>ipsweep</td>\n",
       "      <td>15</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>125948</th>\n",
       "      <td>0</td>\n",
       "      <td>tcp</td>\n",
       "      <td>SG8</td>\n",
       "      <td>FG1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>126</td>\n",
       "      <td>17</td>\n",
       "      <td>1.00</td>\n",
       "      <td>1.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.13</td>\n",
       "      <td>0.06</td>\n",
       "      <td>0.00</td>\n",
       "      <td>255</td>\n",
       "      <td>13</td>\n",
       "      <td>0.05</td>\n",
       "      <td>0.07</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>1.00</td>\n",
       "      <td>1.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>neptune</td>\n",
       "      <td>21</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>125949</th>\n",
       "      <td>0</td>\n",
       "      <td>tcp</td>\n",
       "      <td>SG4</td>\n",
       "      <td>FG1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>2</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>1.00</td>\n",
       "      <td>1.00</td>\n",
       "      <td>1.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>1.00</td>\n",
       "      <td>255</td>\n",
       "      <td>255</td>\n",
       "      <td>1.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>normal</td>\n",
       "      <td>21</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>125950</th>\n",
       "      <td>0</td>\n",
       "      <td>udp</td>\n",
       "      <td>SG8</td>\n",
       "      <td>FG2</td>\n",
       "      <td>28</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>3</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>3</td>\n",
       "      <td>3</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>1.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>255</td>\n",
       "      <td>3</td>\n",
       "      <td>0.01</td>\n",
       "      <td>0.01</td>\n",
       "      <td>0.01</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>teardrop</td>\n",
       "      <td>16</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>125951</th>\n",
       "      <td>0</td>\n",
       "      <td>tcp</td>\n",
       "      <td>SG4</td>\n",
       "      <td>FG2</td>\n",
       "      <td>254</td>\n",
       "      <td>555</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>3</td>\n",
       "      <td>3</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>1.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>35</td>\n",
       "      <td>170</td>\n",
       "      <td>1.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.03</td>\n",
       "      <td>0.04</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>normal</td>\n",
       "      <td>21</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>125952</th>\n",
       "      <td>0</td>\n",
       "      <td>tcp</td>\n",
       "      <td>SG3</td>\n",
       "      <td>FG2</td>\n",
       "      <td>1289</td>\n",
       "      <td>408</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>1.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>255</td>\n",
       "      <td>58</td>\n",
       "      <td>0.23</td>\n",
       "      <td>0.06</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.51</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.02</td>\n",
       "      <td>0.00</td>\n",
       "      <td>normal</td>\n",
       "      <td>15</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>125953</th>\n",
       "      <td>0</td>\n",
       "      <td>tcp</td>\n",
       "      <td>SG8</td>\n",
       "      <td>FG1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>109</td>\n",
       "      <td>9</td>\n",
       "      <td>1.00</td>\n",
       "      <td>1.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.08</td>\n",
       "      <td>0.05</td>\n",
       "      <td>0.00</td>\n",
       "      <td>255</td>\n",
       "      <td>9</td>\n",
       "      <td>0.04</td>\n",
       "      <td>0.04</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>1.00</td>\n",
       "      <td>1.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>neptune</td>\n",
       "      <td>18</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>125954</th>\n",
       "      <td>0</td>\n",
       "      <td>tcp</td>\n",
       "      <td>SG4</td>\n",
       "      <td>FG2</td>\n",
       "      <td>269</td>\n",
       "      <td>10939</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>20</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>1.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.15</td>\n",
       "      <td>20</td>\n",
       "      <td>255</td>\n",
       "      <td>1.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.05</td>\n",
       "      <td>0.04</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>normal</td>\n",
       "      <td>21</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>125955</th>\n",
       "      <td>0</td>\n",
       "      <td>tcp</td>\n",
       "      <td>SG4</td>\n",
       "      <td>FG1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>2</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>1.00</td>\n",
       "      <td>1.00</td>\n",
       "      <td>1.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>1.00</td>\n",
       "      <td>1</td>\n",
       "      <td>220</td>\n",
       "      <td>1.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>1.00</td>\n",
       "      <td>0.06</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>1.00</td>\n",
       "      <td>1.00</td>\n",
       "      <td>normal</td>\n",
       "      <td>21</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>125956</th>\n",
       "      <td>0</td>\n",
       "      <td>icmp</td>\n",
       "      <td>SG7</td>\n",
       "      <td>FG2</td>\n",
       "      <td>30</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>3</td>\n",
       "      <td>1</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.33</td>\n",
       "      <td>0.67</td>\n",
       "      <td>0.00</td>\n",
       "      <td>255</td>\n",
       "      <td>4</td>\n",
       "      <td>0.02</td>\n",
       "      <td>0.01</td>\n",
       "      <td>0.03</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>normal</td>\n",
       "      <td>20</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>125957</th>\n",
       "      <td>1</td>\n",
       "      <td>tcp</td>\n",
       "      <td>SG3</td>\n",
       "      <td>FG2</td>\n",
       "      <td>1247</td>\n",
       "      <td>327</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>1.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>226</td>\n",
       "      <td>129</td>\n",
       "      <td>0.53</td>\n",
       "      <td>0.03</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.02</td>\n",
       "      <td>0.01</td>\n",
       "      <td>0.02</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>normal</td>\n",
       "      <td>21</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>125958</th>\n",
       "      <td>0</td>\n",
       "      <td>tcp</td>\n",
       "      <td>SG8</td>\n",
       "      <td>FG1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>130</td>\n",
       "      <td>14</td>\n",
       "      <td>1.00</td>\n",
       "      <td>1.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.11</td>\n",
       "      <td>0.05</td>\n",
       "      <td>0.00</td>\n",
       "      <td>255</td>\n",
       "      <td>4</td>\n",
       "      <td>0.02</td>\n",
       "      <td>0.05</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>1.00</td>\n",
       "      <td>1.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>neptune</td>\n",
       "      <td>21</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>125959</th>\n",
       "      <td>0</td>\n",
       "      <td>tcp</td>\n",
       "      <td>SG4</td>\n",
       "      <td>FG2</td>\n",
       "      <td>373</td>\n",
       "      <td>4777</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>5</td>\n",
       "      <td>5</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>1.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>62</td>\n",
       "      <td>255</td>\n",
       "      <td>1.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.02</td>\n",
       "      <td>0.04</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>normal</td>\n",
       "      <td>21</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>125960</th>\n",
       "      <td>0</td>\n",
       "      <td>tcp</td>\n",
       "      <td>SG4</td>\n",
       "      <td>FG2</td>\n",
       "      <td>329</td>\n",
       "      <td>885</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>14</td>\n",
       "      <td>14</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>1.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>255</td>\n",
       "      <td>255</td>\n",
       "      <td>1.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>normal</td>\n",
       "      <td>21</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>125961</th>\n",
       "      <td>0</td>\n",
       "      <td>tcp</td>\n",
       "      <td>SG4</td>\n",
       "      <td>FG2</td>\n",
       "      <td>236</td>\n",
       "      <td>2698</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>1.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>255</td>\n",
       "      <td>247</td>\n",
       "      <td>0.97</td>\n",
       "      <td>0.01</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>normal</td>\n",
       "      <td>21</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>125962</th>\n",
       "      <td>0</td>\n",
       "      <td>udp</td>\n",
       "      <td>SG6</td>\n",
       "      <td>FG2</td>\n",
       "      <td>33</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>2</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>1.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>1.00</td>\n",
       "      <td>127</td>\n",
       "      <td>17</td>\n",
       "      <td>0.13</td>\n",
       "      <td>0.03</td>\n",
       "      <td>0.13</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>normal</td>\n",
       "      <td>21</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>125963</th>\n",
       "      <td>0</td>\n",
       "      <td>tcp</td>\n",
       "      <td>SG4</td>\n",
       "      <td>FG2</td>\n",
       "      <td>334</td>\n",
       "      <td>1600</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>3</td>\n",
       "      <td>3</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>1.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>255</td>\n",
       "      <td>255</td>\n",
       "      <td>1.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>normal</td>\n",
       "      <td>21</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>125964</th>\n",
       "      <td>0</td>\n",
       "      <td>tcp</td>\n",
       "      <td>SG8</td>\n",
       "      <td>FG1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>128</td>\n",
       "      <td>9</td>\n",
       "      <td>1.00</td>\n",
       "      <td>1.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.07</td>\n",
       "      <td>0.05</td>\n",
       "      <td>0.00</td>\n",
       "      <td>255</td>\n",
       "      <td>12</td>\n",
       "      <td>0.05</td>\n",
       "      <td>0.06</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>1.00</td>\n",
       "      <td>1.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>neptune</td>\n",
       "      <td>21</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>125965</th>\n",
       "      <td>0</td>\n",
       "      <td>tcp</td>\n",
       "      <td>SG3</td>\n",
       "      <td>FG2</td>\n",
       "      <td>2233</td>\n",
       "      <td>365</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>1.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>1</td>\n",
       "      <td>2</td>\n",
       "      <td>1.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>1.00</td>\n",
       "      <td>1.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>normal</td>\n",
       "      <td>19</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>125966</th>\n",
       "      <td>0</td>\n",
       "      <td>tcp</td>\n",
       "      <td>SG8</td>\n",
       "      <td>FG1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>113</td>\n",
       "      <td>3</td>\n",
       "      <td>1.00</td>\n",
       "      <td>1.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.03</td>\n",
       "      <td>0.07</td>\n",
       "      <td>0.00</td>\n",
       "      <td>255</td>\n",
       "      <td>13</td>\n",
       "      <td>0.05</td>\n",
       "      <td>0.07</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>1.00</td>\n",
       "      <td>1.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>neptune</td>\n",
       "      <td>21</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>125967</th>\n",
       "      <td>0</td>\n",
       "      <td>tcp</td>\n",
       "      <td>SG4</td>\n",
       "      <td>FG2</td>\n",
       "      <td>359</td>\n",
       "      <td>375</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>3</td>\n",
       "      <td>11</td>\n",
       "      <td>0.33</td>\n",
       "      <td>0.09</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>1.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.18</td>\n",
       "      <td>3</td>\n",
       "      <td>255</td>\n",
       "      <td>1.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.33</td>\n",
       "      <td>0.04</td>\n",
       "      <td>0.33</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>normal</td>\n",
       "      <td>18</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>125968</th>\n",
       "      <td>0</td>\n",
       "      <td>tcp</td>\n",
       "      <td>SG8</td>\n",
       "      <td>FG1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>184</td>\n",
       "      <td>25</td>\n",
       "      <td>1.00</td>\n",
       "      <td>1.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.14</td>\n",
       "      <td>0.06</td>\n",
       "      <td>0.00</td>\n",
       "      <td>255</td>\n",
       "      <td>25</td>\n",
       "      <td>0.10</td>\n",
       "      <td>0.06</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>1.00</td>\n",
       "      <td>1.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>neptune</td>\n",
       "      <td>20</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>125969</th>\n",
       "      <td>8</td>\n",
       "      <td>udp</td>\n",
       "      <td>SG8</td>\n",
       "      <td>FG2</td>\n",
       "      <td>105</td>\n",
       "      <td>145</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>1.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>255</td>\n",
       "      <td>244</td>\n",
       "      <td>0.96</td>\n",
       "      <td>0.01</td>\n",
       "      <td>0.01</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>normal</td>\n",
       "      <td>21</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>125970</th>\n",
       "      <td>0</td>\n",
       "      <td>tcp</td>\n",
       "      <td>SG3</td>\n",
       "      <td>FG2</td>\n",
       "      <td>2231</td>\n",
       "      <td>384</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>1.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>255</td>\n",
       "      <td>30</td>\n",
       "      <td>0.12</td>\n",
       "      <td>0.06</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.72</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.01</td>\n",
       "      <td>0.00</td>\n",
       "      <td>normal</td>\n",
       "      <td>18</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>125971</th>\n",
       "      <td>0</td>\n",
       "      <td>tcp</td>\n",
       "      <td>SG8</td>\n",
       "      <td>FG1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>144</td>\n",
       "      <td>8</td>\n",
       "      <td>1.00</td>\n",
       "      <td>1.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.06</td>\n",
       "      <td>0.05</td>\n",
       "      <td>0.00</td>\n",
       "      <td>255</td>\n",
       "      <td>8</td>\n",
       "      <td>0.03</td>\n",
       "      <td>0.05</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>1.00</td>\n",
       "      <td>1.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>neptune</td>\n",
       "      <td>20</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>125972</th>\n",
       "      <td>0</td>\n",
       "      <td>tcp</td>\n",
       "      <td>SG2</td>\n",
       "      <td>FG2</td>\n",
       "      <td>151</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>1.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>255</td>\n",
       "      <td>77</td>\n",
       "      <td>0.30</td>\n",
       "      <td>0.03</td>\n",
       "      <td>0.30</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>normal</td>\n",
       "      <td>21</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>125973 rows × 43 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "        duration protocol_type service flag  src_bytes  dst_bytes  land  \\\n",
       "0              0           tcp     SG2  FG2        491          0     0   \n",
       "1              0           udp     SG8  FG2        146          0     0   \n",
       "2              0           tcp     SG8  FG1          0          0     0   \n",
       "3              0           tcp     SG4  FG2        232       8153     0   \n",
       "4              0           tcp     SG4  FG2        199        420     0   \n",
       "5              0           tcp     SG8  FG1          0          0     0   \n",
       "6              0           tcp     SG8  FG1          0          0     0   \n",
       "7              0           tcp     SG8  FG1          0          0     0   \n",
       "8              0           tcp     SG8  FG1          0          0     0   \n",
       "9              0           tcp     SG8  FG1          0          0     0   \n",
       "10             0           tcp     SG8  FG1          0          0     0   \n",
       "11             0           tcp     SG8  FG1          0          0     0   \n",
       "12             0           tcp     SG4  FG2        287       2251     0   \n",
       "13             0           tcp     SG2  FG2        334          0     0   \n",
       "14             0           tcp     SG8  FG1          0          0     0   \n",
       "15             0           tcp     SG8  FG1          0          0     0   \n",
       "16             0           tcp     SG4  FG2        300      13788     0   \n",
       "17             0          icmp     SG7  FG2         18          0     0   \n",
       "18             0           tcp     SG4  FG2        233        616     0   \n",
       "19             0           tcp     SG4  FG2        343       1178     0   \n",
       "20             0           tcp     SG8  FG1          0          0     0   \n",
       "21             0           tcp     SG8  FG1          0          0     0   \n",
       "22             0           tcp     SG4  FG2        253      11905     0   \n",
       "23          5607           udp     SG8  FG2        147        105     0   \n",
       "24             0           tcp     SG8  FG1          0          0     0   \n",
       "25           507           tcp     SG1  FG2        437      14421     0   \n",
       "26             0           tcp     SG8  FG1          0          0     0   \n",
       "27             0           tcp     SG4  FG2        227       6588     0   \n",
       "28             0           tcp     SG4  FG2        215      10499     0   \n",
       "29             0           tcp     SG4  FG2        241       1400     0   \n",
       "...          ...           ...     ...  ...        ...        ...   ...   \n",
       "125943         0           tcp     SG2  FG2        491          0     0   \n",
       "125944         1           tcp     SG3  FG2       2049        362     0   \n",
       "125945         0           tcp     SG4  FG2        247        799     0   \n",
       "125946         0           tcp     SG5  FG1          0          0     0   \n",
       "125947         0          icmp     SG7  FG2         18          0     0   \n",
       "125948         0           tcp     SG8  FG1          0          0     0   \n",
       "125949         0           tcp     SG4  FG1          0          0     0   \n",
       "125950         0           udp     SG8  FG2         28          0     0   \n",
       "125951         0           tcp     SG4  FG2        254        555     0   \n",
       "125952         0           tcp     SG3  FG2       1289        408     0   \n",
       "125953         0           tcp     SG8  FG1          0          0     0   \n",
       "125954         0           tcp     SG4  FG2        269      10939     0   \n",
       "125955         0           tcp     SG4  FG1          0          0     0   \n",
       "125956         0          icmp     SG7  FG2         30          0     0   \n",
       "125957         1           tcp     SG3  FG2       1247        327     0   \n",
       "125958         0           tcp     SG8  FG1          0          0     0   \n",
       "125959         0           tcp     SG4  FG2        373       4777     0   \n",
       "125960         0           tcp     SG4  FG2        329        885     0   \n",
       "125961         0           tcp     SG4  FG2        236       2698     0   \n",
       "125962         0           udp     SG6  FG2         33          0     0   \n",
       "125963         0           tcp     SG4  FG2        334       1600     0   \n",
       "125964         0           tcp     SG8  FG1          0          0     0   \n",
       "125965         0           tcp     SG3  FG2       2233        365     0   \n",
       "125966         0           tcp     SG8  FG1          0          0     0   \n",
       "125967         0           tcp     SG4  FG2        359        375     0   \n",
       "125968         0           tcp     SG8  FG1          0          0     0   \n",
       "125969         8           udp     SG8  FG2        105        145     0   \n",
       "125970         0           tcp     SG3  FG2       2231        384     0   \n",
       "125971         0           tcp     SG8  FG1          0          0     0   \n",
       "125972         0           tcp     SG2  FG2        151          0     0   \n",
       "\n",
       "        wrong_fragment  urgent  hot  num_failed_logins  logged_in  \\\n",
       "0                    0       0    0                  0          0   \n",
       "1                    0       0    0                  0          0   \n",
       "2                    0       0    0                  0          0   \n",
       "3                    0       0    0                  0          1   \n",
       "4                    0       0    0                  0          1   \n",
       "5                    0       0    0                  0          0   \n",
       "6                    0       0    0                  0          0   \n",
       "7                    0       0    0                  0          0   \n",
       "8                    0       0    0                  0          0   \n",
       "9                    0       0    0                  0          0   \n",
       "10                   0       0    0                  0          0   \n",
       "11                   0       0    0                  0          0   \n",
       "12                   0       0    0                  0          1   \n",
       "13                   0       0    0                  0          1   \n",
       "14                   0       0    0                  0          0   \n",
       "15                   0       0    0                  0          0   \n",
       "16                   0       0    0                  0          1   \n",
       "17                   0       0    0                  0          0   \n",
       "18                   0       0    0                  0          1   \n",
       "19                   0       0    0                  0          1   \n",
       "20                   0       0    0                  0          0   \n",
       "21                   0       0    0                  0          0   \n",
       "22                   0       0    0                  0          1   \n",
       "23                   0       0    0                  0          0   \n",
       "24                   0       0    0                  0          0   \n",
       "25                   0       0    0                  0          1   \n",
       "26                   0       0    0                  0          0   \n",
       "27                   0       0    0                  0          1   \n",
       "28                   0       0    0                  0          1   \n",
       "29                   0       0    0                  0          1   \n",
       "...                ...     ...  ...                ...        ...   \n",
       "125943               0       0    0                  0          1   \n",
       "125944               0       0    0                  0          1   \n",
       "125945               0       0    0                  0          1   \n",
       "125946               0       0    0                  0          0   \n",
       "125947               0       0    0                  0          0   \n",
       "125948               0       0    0                  0          0   \n",
       "125949               0       0    0                  0          0   \n",
       "125950               3       0    0                  0          0   \n",
       "125951               0       0    0                  0          1   \n",
       "125952               0       0    0                  0          1   \n",
       "125953               0       0    0                  0          0   \n",
       "125954               0       0    0                  0          1   \n",
       "125955               0       0    0                  0          0   \n",
       "125956               0       0    0                  0          0   \n",
       "125957               0       0    0                  0          1   \n",
       "125958               0       0    0                  0          0   \n",
       "125959               0       0    0                  0          1   \n",
       "125960               0       0    0                  0          1   \n",
       "125961               0       0    0                  0          1   \n",
       "125962               0       0    0                  0          0   \n",
       "125963               0       0    0                  0          1   \n",
       "125964               0       0    0                  0          0   \n",
       "125965               0       0    0                  0          1   \n",
       "125966               0       0    0                  0          0   \n",
       "125967               0       0    0                  0          1   \n",
       "125968               0       0    0                  0          0   \n",
       "125969               0       0    0                  0          0   \n",
       "125970               0       0    0                  0          1   \n",
       "125971               0       0    0                  0          0   \n",
       "125972               0       0    0                  0          1   \n",
       "\n",
       "        num_compromised  root_shell  su_attempted  num_root  \\\n",
       "0                     0           0             0         0   \n",
       "1                     0           0             0         0   \n",
       "2                     0           0             0         0   \n",
       "3                     0           0             0         0   \n",
       "4                     0           0             0         0   \n",
       "5                     0           0             0         0   \n",
       "6                     0           0             0         0   \n",
       "7                     0           0             0         0   \n",
       "8                     0           0             0         0   \n",
       "9                     0           0             0         0   \n",
       "10                    0           0             0         0   \n",
       "11                    0           0             0         0   \n",
       "12                    0           0             0         0   \n",
       "13                    0           0             0         0   \n",
       "14                    0           0             0         0   \n",
       "15                    0           0             0         0   \n",
       "16                    0           0             0         0   \n",
       "17                    0           0             0         0   \n",
       "18                    0           0             0         0   \n",
       "19                    0           0             0         0   \n",
       "20                    0           0             0         0   \n",
       "21                    0           0             0         0   \n",
       "22                    0           0             0         0   \n",
       "23                    0           0             0         0   \n",
       "24                    0           0             0         0   \n",
       "25                    3           0             0         0   \n",
       "26                    0           0             0         0   \n",
       "27                    0           0             0         0   \n",
       "28                    0           0             0         0   \n",
       "29                    0           0             0         0   \n",
       "...                 ...         ...           ...       ...   \n",
       "125943                0           0             0         5   \n",
       "125944                0           0             0         0   \n",
       "125945                0           0             0         0   \n",
       "125946                0           0             0         0   \n",
       "125947                0           0             0         0   \n",
       "125948                0           0             0         0   \n",
       "125949                0           0             0         0   \n",
       "125950                0           0             0         0   \n",
       "125951                0           0             0         0   \n",
       "125952                0           0             0         0   \n",
       "125953                0           0             0         0   \n",
       "125954                0           0             0         0   \n",
       "125955                0           0             0         0   \n",
       "125956                0           0             0         0   \n",
       "125957                0           0             0         0   \n",
       "125958                0           0             0         0   \n",
       "125959                0           0             0         0   \n",
       "125960                0           0             0         0   \n",
       "125961                0           0             0         0   \n",
       "125962                0           0             0         0   \n",
       "125963                0           0             0         0   \n",
       "125964                0           0             0         0   \n",
       "125965                0           0             0         0   \n",
       "125966                0           0             0         0   \n",
       "125967                0           0             0         0   \n",
       "125968                0           0             0         0   \n",
       "125969                0           0             0         0   \n",
       "125970                0           0             0         0   \n",
       "125971                0           0             0         0   \n",
       "125972                0           0             0         0   \n",
       "\n",
       "        num_file_creations  num_shells  num_access_files  num_outbound_cmds  \\\n",
       "0                        0           0                 0                  0   \n",
       "1                        0           0                 0                  0   \n",
       "2                        0           0                 0                  0   \n",
       "3                        0           0                 0                  0   \n",
       "4                        0           0                 0                  0   \n",
       "5                        0           0                 0                  0   \n",
       "6                        0           0                 0                  0   \n",
       "7                        0           0                 0                  0   \n",
       "8                        0           0                 0                  0   \n",
       "9                        0           0                 0                  0   \n",
       "10                       0           0                 0                  0   \n",
       "11                       0           0                 0                  0   \n",
       "12                       0           0                 0                  0   \n",
       "13                       0           0                 0                  0   \n",
       "14                       0           0                 0                  0   \n",
       "15                       0           0                 0                  0   \n",
       "16                       0           0                 0                  0   \n",
       "17                       0           0                 0                  0   \n",
       "18                       0           0                 0                  0   \n",
       "19                       0           0                 0                  0   \n",
       "20                       0           0                 0                  0   \n",
       "21                       0           0                 0                  0   \n",
       "22                       0           0                 0                  0   \n",
       "23                       0           0                 0                  0   \n",
       "24                       0           0                 0                  0   \n",
       "25                       0           0                 1                  0   \n",
       "26                       0           0                 0                  0   \n",
       "27                       0           0                 0                  0   \n",
       "28                       0           0                 0                  0   \n",
       "29                       0           0                 0                  0   \n",
       "...                    ...         ...               ...                ...   \n",
       "125943                   0           0                 0                  0   \n",
       "125944                   0           0                 0                  0   \n",
       "125945                   0           0                 0                  0   \n",
       "125946                   0           0                 0                  0   \n",
       "125947                   0           0                 0                  0   \n",
       "125948                   0           0                 0                  0   \n",
       "125949                   0           0                 0                  0   \n",
       "125950                   0           0                 0                  0   \n",
       "125951                   0           0                 0                  0   \n",
       "125952                   0           0                 0                  0   \n",
       "125953                   0           0                 0                  0   \n",
       "125954                   0           0                 0                  0   \n",
       "125955                   0           0                 0                  0   \n",
       "125956                   0           0                 0                  0   \n",
       "125957                   0           0                 0                  0   \n",
       "125958                   0           0                 0                  0   \n",
       "125959                   0           0                 0                  0   \n",
       "125960                   0           0                 0                  0   \n",
       "125961                   0           0                 1                  0   \n",
       "125962                   0           0                 0                  0   \n",
       "125963                   0           0                 0                  0   \n",
       "125964                   0           0                 0                  0   \n",
       "125965                   0           0                 0                  0   \n",
       "125966                   0           0                 0                  0   \n",
       "125967                   0           0                 0                  0   \n",
       "125968                   0           0                 0                  0   \n",
       "125969                   0           0                 0                  0   \n",
       "125970                   0           0                 0                  0   \n",
       "125971                   0           0                 0                  0   \n",
       "125972                   0           0                 0                  0   \n",
       "\n",
       "        is_host_login  is_guest_login  count  srv_count  serror_rate  \\\n",
       "0                   0               0      2          2         0.00   \n",
       "1                   0               0     13          1         0.00   \n",
       "2                   0               0    123          6         1.00   \n",
       "3                   0               0      5          5         0.20   \n",
       "4                   0               0     30         32         0.00   \n",
       "5                   0               0    121         19         0.00   \n",
       "6                   0               0    166          9         1.00   \n",
       "7                   0               0    117         16         1.00   \n",
       "8                   0               0    270         23         1.00   \n",
       "9                   0               0    133          8         1.00   \n",
       "10                  0               0    205         12         0.00   \n",
       "11                  0               0    199          3         1.00   \n",
       "12                  0               0      3          7         0.00   \n",
       "13                  0               0      2          2         0.00   \n",
       "14                  0               0    233          1         1.00   \n",
       "15                  0               0     96         16         1.00   \n",
       "16                  0               0      8          9         0.00   \n",
       "17                  0               0      1          1         0.00   \n",
       "18                  0               0      3          3         0.00   \n",
       "19                  0               0      9         10         0.00   \n",
       "20                  0               0    223         23         1.00   \n",
       "21                  0               0    280         17         1.00   \n",
       "22                  0               0      8         10         0.00   \n",
       "23                  0               0      1          1         0.00   \n",
       "24                  0               0    248          2         1.00   \n",
       "25                  0               0      1          1         0.00   \n",
       "26                  0               0    279          7         1.00   \n",
       "27                  0               0      5         22         0.00   \n",
       "28                  0               0     14         14         0.00   \n",
       "29                  0               0     33         33         0.00   \n",
       "...               ...             ...    ...        ...          ...   \n",
       "125943              0               0      2          2         0.00   \n",
       "125944              0               0      1          4         0.00   \n",
       "125945              0               0      4          4         0.00   \n",
       "125946              0               0    288         13         1.00   \n",
       "125947              0               0      1          1         0.00   \n",
       "125948              0               0    126         17         1.00   \n",
       "125949              0               0      1          2         0.00   \n",
       "125950              0               0      3          3         0.00   \n",
       "125951              0               0      3          3         0.00   \n",
       "125952              0               0      1          1         0.00   \n",
       "125953              0               0    109          9         1.00   \n",
       "125954              0               0      1         20         0.00   \n",
       "125955              0               0      1          2         0.00   \n",
       "125956              0               0      3          1         0.00   \n",
       "125957              0               0      1          1         0.00   \n",
       "125958              0               0    130         14         1.00   \n",
       "125959              0               0      5          5         0.00   \n",
       "125960              0               0     14         14         0.00   \n",
       "125961              0               0      2          2         0.00   \n",
       "125962              0               0      1          2         0.00   \n",
       "125963              0               0      3          3         0.00   \n",
       "125964              0               0    128          9         1.00   \n",
       "125965              0               0      1          1         0.00   \n",
       "125966              0               0    113          3         1.00   \n",
       "125967              0               0      3         11         0.33   \n",
       "125968              0               0    184         25         1.00   \n",
       "125969              0               0      2          2         0.00   \n",
       "125970              0               0      1          1         0.00   \n",
       "125971              0               0    144          8         1.00   \n",
       "125972              0               0      1          1         0.00   \n",
       "\n",
       "        srv_serror_rate  rerror_rate  srv_rerror_rate  same_srv_rate  \\\n",
       "0                  0.00         0.00             0.00           1.00   \n",
       "1                  0.00         0.00             0.00           0.08   \n",
       "2                  1.00         0.00             0.00           0.05   \n",
       "3                  0.20         0.00             0.00           1.00   \n",
       "4                  0.00         0.00             0.00           1.00   \n",
       "5                  0.00         1.00             1.00           0.16   \n",
       "6                  1.00         0.00             0.00           0.05   \n",
       "7                  1.00         0.00             0.00           0.14   \n",
       "8                  1.00         0.00             0.00           0.09   \n",
       "9                  1.00         0.00             0.00           0.06   \n",
       "10                 0.00         1.00             1.00           0.06   \n",
       "11                 1.00         0.00             0.00           0.02   \n",
       "12                 0.00         0.00             0.00           1.00   \n",
       "13                 0.00         0.00             0.00           1.00   \n",
       "14                 1.00         0.00             0.00           0.00   \n",
       "15                 1.00         0.00             0.00           0.17   \n",
       "16                 0.11         0.00             0.00           1.00   \n",
       "17                 0.00         0.00             0.00           1.00   \n",
       "18                 0.00         0.00             0.00           1.00   \n",
       "19                 0.00         0.00             0.00           1.00   \n",
       "20                 1.00         0.00             0.00           0.10   \n",
       "21                 1.00         0.00             0.00           0.06   \n",
       "22                 0.00         0.00             0.00           1.00   \n",
       "23                 0.00         0.00             0.00           1.00   \n",
       "24                 1.00         0.00             0.00           0.01   \n",
       "25                 0.00         0.00             0.00           1.00   \n",
       "26                 1.00         0.00             0.00           0.03   \n",
       "27                 0.00         0.00             0.00           1.00   \n",
       "28                 0.00         0.00             0.00           1.00   \n",
       "29                 0.00         0.03             0.03           1.00   \n",
       "...                 ...          ...              ...            ...   \n",
       "125943             0.00         0.00             0.00           1.00   \n",
       "125944             0.00         0.00             0.00           1.00   \n",
       "125945             0.00         0.00             0.00           1.00   \n",
       "125946             1.00         0.00             0.00           0.05   \n",
       "125947             0.00         0.00             0.00           1.00   \n",
       "125948             1.00         0.00             0.00           0.13   \n",
       "125949             0.00         1.00             1.00           1.00   \n",
       "125950             0.00         0.00             0.00           1.00   \n",
       "125951             0.00         0.00             0.00           1.00   \n",
       "125952             0.00         0.00             0.00           1.00   \n",
       "125953             1.00         0.00             0.00           0.08   \n",
       "125954             0.00         0.00             0.00           1.00   \n",
       "125955             0.00         1.00             1.00           1.00   \n",
       "125956             0.00         0.00             0.00           0.33   \n",
       "125957             0.00         0.00             0.00           1.00   \n",
       "125958             1.00         0.00             0.00           0.11   \n",
       "125959             0.00         0.00             0.00           1.00   \n",
       "125960             0.00         0.00             0.00           1.00   \n",
       "125961             0.00         0.00             0.00           1.00   \n",
       "125962             0.00         0.00             0.00           1.00   \n",
       "125963             0.00         0.00             0.00           1.00   \n",
       "125964             1.00         0.00             0.00           0.07   \n",
       "125965             0.00         0.00             0.00           1.00   \n",
       "125966             1.00         0.00             0.00           0.03   \n",
       "125967             0.09         0.00             0.00           1.00   \n",
       "125968             1.00         0.00             0.00           0.14   \n",
       "125969             0.00         0.00             0.00           1.00   \n",
       "125970             0.00         0.00             0.00           1.00   \n",
       "125971             1.00         0.00             0.00           0.06   \n",
       "125972             0.00         0.00             0.00           1.00   \n",
       "\n",
       "        diff_srv_rate  srv_diff_host_rate  dst_host_count  dst_host_srv_count  \\\n",
       "0                0.00                0.00             150                  25   \n",
       "1                0.15                0.00             255                   1   \n",
       "2                0.07                0.00             255                  26   \n",
       "3                0.00                0.00              30                 255   \n",
       "4                0.00                0.09             255                 255   \n",
       "5                0.06                0.00             255                  19   \n",
       "6                0.06                0.00             255                   9   \n",
       "7                0.06                0.00             255                  15   \n",
       "8                0.05                0.00             255                  23   \n",
       "9                0.06                0.00             255                  13   \n",
       "10               0.06                0.00             255                  12   \n",
       "11               0.06                0.00             255                  13   \n",
       "12               0.00                0.43               8                 219   \n",
       "13               0.00                0.00               2                  20   \n",
       "14               0.06                0.00             255                   1   \n",
       "15               0.05                0.00             255                   2   \n",
       "16               0.00                0.22              91                 255   \n",
       "17               0.00                0.00               1                  16   \n",
       "18               0.00                0.00              66                 255   \n",
       "19               0.00                0.20             157                 255   \n",
       "20               0.05                0.00             255                  23   \n",
       "21               0.05                0.00             238                  17   \n",
       "22               0.00                0.20              87                 255   \n",
       "23               0.00                0.00             255                   1   \n",
       "24               0.06                0.00             255                   2   \n",
       "25               0.00                0.00             255                  25   \n",
       "26               0.06                0.00             255                  13   \n",
       "27               0.00                0.18              43                 255   \n",
       "28               0.00                0.00             255                 255   \n",
       "29               0.00                0.00             255                 255   \n",
       "...               ...                 ...             ...                 ...   \n",
       "125943           0.00                0.00               6                  65   \n",
       "125944           0.00                1.00              95                  87   \n",
       "125945           0.00                0.00             192                 255   \n",
       "125946           0.06                0.00             255                  10   \n",
       "125947           0.00                0.00               2                 218   \n",
       "125948           0.06                0.00             255                  13   \n",
       "125949           0.00                1.00             255                 255   \n",
       "125950           0.00                0.00             255                   3   \n",
       "125951           0.00                0.00              35                 170   \n",
       "125952           0.00                0.00             255                  58   \n",
       "125953           0.05                0.00             255                   9   \n",
       "125954           0.00                0.15              20                 255   \n",
       "125955           0.00                1.00               1                 220   \n",
       "125956           0.67                0.00             255                   4   \n",
       "125957           0.00                0.00             226                 129   \n",
       "125958           0.05                0.00             255                   4   \n",
       "125959           0.00                0.00              62                 255   \n",
       "125960           0.00                0.00             255                 255   \n",
       "125961           0.00                0.00             255                 247   \n",
       "125962           0.00                1.00             127                  17   \n",
       "125963           0.00                0.00             255                 255   \n",
       "125964           0.05                0.00             255                  12   \n",
       "125965           0.00                0.00               1                   2   \n",
       "125966           0.07                0.00             255                  13   \n",
       "125967           0.00                0.18               3                 255   \n",
       "125968           0.06                0.00             255                  25   \n",
       "125969           0.00                0.00             255                 244   \n",
       "125970           0.00                0.00             255                  30   \n",
       "125971           0.05                0.00             255                   8   \n",
       "125972           0.00                0.00             255                  77   \n",
       "\n",
       "        dst_host_same_srv_rate  dst_host_diff_srv_rate  \\\n",
       "0                         0.17                    0.03   \n",
       "1                         0.00                    0.60   \n",
       "2                         0.10                    0.05   \n",
       "3                         1.00                    0.00   \n",
       "4                         1.00                    0.00   \n",
       "5                         0.07                    0.07   \n",
       "6                         0.04                    0.05   \n",
       "7                         0.06                    0.07   \n",
       "8                         0.09                    0.05   \n",
       "9                         0.05                    0.06   \n",
       "10                        0.05                    0.07   \n",
       "11                        0.05                    0.07   \n",
       "12                        1.00                    0.00   \n",
       "13                        1.00                    0.00   \n",
       "14                        0.00                    0.07   \n",
       "15                        0.01                    0.06   \n",
       "16                        1.00                    0.00   \n",
       "17                        1.00                    0.00   \n",
       "18                        1.00                    0.00   \n",
       "19                        1.00                    0.00   \n",
       "20                        0.09                    0.05   \n",
       "21                        0.07                    0.06   \n",
       "22                        1.00                    0.00   \n",
       "23                        0.00                    0.85   \n",
       "24                        0.01                    0.06   \n",
       "25                        0.10                    0.05   \n",
       "26                        0.05                    0.07   \n",
       "27                        1.00                    0.00   \n",
       "28                        1.00                    0.00   \n",
       "29                        1.00                    0.00   \n",
       "...                        ...                     ...   \n",
       "125943                    0.33                    0.33   \n",
       "125944                    0.92                    0.02   \n",
       "125945                    1.00                    0.00   \n",
       "125946                    0.04                    0.07   \n",
       "125947                    1.00                    0.00   \n",
       "125948                    0.05                    0.07   \n",
       "125949                    1.00                    0.00   \n",
       "125950                    0.01                    0.01   \n",
       "125951                    1.00                    0.00   \n",
       "125952                    0.23                    0.06   \n",
       "125953                    0.04                    0.04   \n",
       "125954                    1.00                    0.00   \n",
       "125955                    1.00                    0.00   \n",
       "125956                    0.02                    0.01   \n",
       "125957                    0.53                    0.03   \n",
       "125958                    0.02                    0.05   \n",
       "125959                    1.00                    0.00   \n",
       "125960                    1.00                    0.00   \n",
       "125961                    0.97                    0.01   \n",
       "125962                    0.13                    0.03   \n",
       "125963                    1.00                    0.00   \n",
       "125964                    0.05                    0.06   \n",
       "125965                    1.00                    0.00   \n",
       "125966                    0.05                    0.07   \n",
       "125967                    1.00                    0.00   \n",
       "125968                    0.10                    0.06   \n",
       "125969                    0.96                    0.01   \n",
       "125970                    0.12                    0.06   \n",
       "125971                    0.03                    0.05   \n",
       "125972                    0.30                    0.03   \n",
       "\n",
       "        dst_host_same_src_port_rate  dst_host_srv_diff_host_rate  \\\n",
       "0                              0.17                         0.00   \n",
       "1                              0.88                         0.00   \n",
       "2                              0.00                         0.00   \n",
       "3                              0.03                         0.04   \n",
       "4                              0.00                         0.00   \n",
       "5                              0.00                         0.00   \n",
       "6                              0.00                         0.00   \n",
       "7                              0.00                         0.00   \n",
       "8                              0.00                         0.00   \n",
       "9                              0.00                         0.00   \n",
       "10                             0.00                         0.00   \n",
       "11                             0.00                         0.00   \n",
       "12                             0.12                         0.03   \n",
       "13                             1.00                         0.20   \n",
       "14                             0.00                         0.00   \n",
       "15                             0.00                         0.00   \n",
       "16                             0.01                         0.02   \n",
       "17                             1.00                         1.00   \n",
       "18                             0.02                         0.03   \n",
       "19                             0.01                         0.04   \n",
       "20                             0.00                         0.00   \n",
       "21                             0.00                         0.00   \n",
       "22                             0.01                         0.02   \n",
       "23                             1.00                         0.00   \n",
       "24                             0.00                         0.00   \n",
       "25                             0.00                         0.00   \n",
       "26                             0.00                         0.00   \n",
       "27                             0.02                         0.14   \n",
       "28                             0.00                         0.00   \n",
       "29                             0.00                         0.00   \n",
       "...                             ...                          ...   \n",
       "125943                         0.33                         0.03   \n",
       "125944                         0.01                         0.00   \n",
       "125945                         0.01                         0.02   \n",
       "125946                         0.00                         0.00   \n",
       "125947                         1.00                         0.25   \n",
       "125948                         0.00                         0.00   \n",
       "125949                         0.00                         0.00   \n",
       "125950                         0.01                         0.00   \n",
       "125951                         0.03                         0.04   \n",
       "125952                         0.00                         0.00   \n",
       "125953                         0.00                         0.00   \n",
       "125954                         0.05                         0.04   \n",
       "125955                         1.00                         0.06   \n",
       "125956                         0.03                         0.00   \n",
       "125957                         0.00                         0.02   \n",
       "125958                         0.00                         0.00   \n",
       "125959                         0.02                         0.04   \n",
       "125960                         0.00                         0.00   \n",
       "125961                         0.00                         0.00   \n",
       "125962                         0.13                         0.00   \n",
       "125963                         0.00                         0.00   \n",
       "125964                         0.00                         0.00   \n",
       "125965                         1.00                         1.00   \n",
       "125966                         0.00                         0.00   \n",
       "125967                         0.33                         0.04   \n",
       "125968                         0.00                         0.00   \n",
       "125969                         0.01                         0.00   \n",
       "125970                         0.00                         0.00   \n",
       "125971                         0.00                         0.00   \n",
       "125972                         0.30                         0.00   \n",
       "\n",
       "        dst_host_serror_rate  dst_host_srv_serror_rate  dst_host_rerror_rate  \\\n",
       "0                       0.00                      0.00                  0.05   \n",
       "1                       0.00                      0.00                  0.00   \n",
       "2                       1.00                      1.00                  0.00   \n",
       "3                       0.03                      0.01                  0.00   \n",
       "4                       0.00                      0.00                  0.00   \n",
       "5                       0.00                      0.00                  1.00   \n",
       "6                       1.00                      1.00                  0.00   \n",
       "7                       1.00                      1.00                  0.00   \n",
       "8                       1.00                      1.00                  0.00   \n",
       "9                       1.00                      1.00                  0.00   \n",
       "10                      0.00                      0.00                  1.00   \n",
       "11                      1.00                      1.00                  0.00   \n",
       "12                      0.00                      0.00                  0.00   \n",
       "13                      0.00                      0.00                  0.00   \n",
       "14                      1.00                      1.00                  0.00   \n",
       "15                      1.00                      1.00                  0.00   \n",
       "16                      0.00                      0.00                  0.00   \n",
       "17                      0.00                      0.00                  0.00   \n",
       "18                      0.00                      0.00                  0.02   \n",
       "19                      0.00                      0.00                  0.00   \n",
       "20                      1.00                      1.00                  0.00   \n",
       "21                      0.99                      1.00                  0.00   \n",
       "22                      0.00                      0.00                  0.00   \n",
       "23                      0.00                      0.00                  0.00   \n",
       "24                      1.00                      1.00                  0.00   \n",
       "25                      0.53                      0.00                  0.02   \n",
       "26                      1.00                      1.00                  0.00   \n",
       "27                      0.00                      0.00                  0.56   \n",
       "28                      0.00                      0.00                  0.00   \n",
       "29                      0.00                      0.00                  0.00   \n",
       "...                      ...                       ...                   ...   \n",
       "125943                  0.00                      0.00                  0.00   \n",
       "125944                  0.00                      0.00                  0.00   \n",
       "125945                  0.00                      0.00                  0.00   \n",
       "125946                  1.00                      1.00                  0.00   \n",
       "125947                  0.00                      0.00                  0.00   \n",
       "125948                  1.00                      1.00                  0.00   \n",
       "125949                  0.00                      0.00                  0.00   \n",
       "125950                  0.00                      0.00                  0.00   \n",
       "125951                  0.00                      0.00                  0.00   \n",
       "125952                  0.51                      0.00                  0.02   \n",
       "125953                  1.00                      1.00                  0.00   \n",
       "125954                  0.00                      0.00                  0.00   \n",
       "125955                  0.00                      0.00                  1.00   \n",
       "125956                  0.00                      0.00                  0.00   \n",
       "125957                  0.01                      0.02                  0.00   \n",
       "125958                  1.00                      1.00                  0.00   \n",
       "125959                  0.00                      0.00                  0.00   \n",
       "125960                  0.00                      0.00                  0.00   \n",
       "125961                  0.00                      0.00                  0.00   \n",
       "125962                  0.00                      0.00                  0.00   \n",
       "125963                  0.00                      0.00                  0.00   \n",
       "125964                  1.00                      1.00                  0.00   \n",
       "125965                  0.00                      0.00                  0.00   \n",
       "125966                  1.00                      1.00                  0.00   \n",
       "125967                  0.33                      0.00                  0.00   \n",
       "125968                  1.00                      1.00                  0.00   \n",
       "125969                  0.00                      0.00                  0.00   \n",
       "125970                  0.72                      0.00                  0.01   \n",
       "125971                  1.00                      1.00                  0.00   \n",
       "125972                  0.00                      0.00                  0.00   \n",
       "\n",
       "        dst_host_srv_rerror_rate      outcome  attack  \n",
       "0                           0.00       normal      20  \n",
       "1                           0.00       normal      15  \n",
       "2                           0.00      neptune      19  \n",
       "3                           0.01       normal      21  \n",
       "4                           0.00       normal      21  \n",
       "5                           1.00      neptune      21  \n",
       "6                           0.00      neptune      21  \n",
       "7                           0.00      neptune      21  \n",
       "8                           0.00      neptune      21  \n",
       "9                           0.00      neptune      21  \n",
       "10                          1.00      neptune      21  \n",
       "11                          0.00      neptune      21  \n",
       "12                          0.00       normal      21  \n",
       "13                          0.00  warezclient      15  \n",
       "14                          0.00      neptune      19  \n",
       "15                          0.00      neptune      18  \n",
       "16                          0.00       normal      21  \n",
       "17                          0.00      ipsweep      18  \n",
       "18                          0.00       normal      21  \n",
       "19                          0.00       normal      21  \n",
       "20                          0.00      neptune      18  \n",
       "21                          0.00      neptune      18  \n",
       "22                          0.00       normal      21  \n",
       "23                          0.00       normal      21  \n",
       "24                          0.00      neptune      19  \n",
       "25                          0.16       normal      20  \n",
       "26                          0.00      neptune      21  \n",
       "27                          0.57       normal      21  \n",
       "28                          0.00       normal      21  \n",
       "29                          0.00       normal      21  \n",
       "...                          ...          ...     ...  \n",
       "125943                      0.00       normal      21  \n",
       "125944                      0.00       normal      21  \n",
       "125945                      0.00       normal      21  \n",
       "125946                      0.00      neptune      20  \n",
       "125947                      0.00      ipsweep      15  \n",
       "125948                      0.00      neptune      21  \n",
       "125949                      0.00       normal      21  \n",
       "125950                      0.00     teardrop      16  \n",
       "125951                      0.00       normal      21  \n",
       "125952                      0.00       normal      15  \n",
       "125953                      0.00      neptune      18  \n",
       "125954                      0.00       normal      21  \n",
       "125955                      1.00       normal      21  \n",
       "125956                      0.00       normal      20  \n",
       "125957                      0.00       normal      21  \n",
       "125958                      0.00      neptune      21  \n",
       "125959                      0.00       normal      21  \n",
       "125960                      0.00       normal      21  \n",
       "125961                      0.00       normal      21  \n",
       "125962                      0.00       normal      21  \n",
       "125963                      0.00       normal      21  \n",
       "125964                      0.00      neptune      21  \n",
       "125965                      0.00       normal      19  \n",
       "125966                      0.00      neptune      21  \n",
       "125967                      0.00       normal      18  \n",
       "125968                      0.00      neptune      20  \n",
       "125969                      0.00       normal      21  \n",
       "125970                      0.00       normal      18  \n",
       "125971                      0.00      neptune      20  \n",
       "125972                      0.00       normal      21  \n",
       "\n",
       "[125973 rows x 43 columns]"
      ]
     },
     "execution_count": 3,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "flag_feature_cluster(df)\n",
    "service_feature_cluster(df)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## 資料預處理"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "0.5445437431335449 seconds\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "C:\\Users\\sss83327\\Anaconda3\\lib\\site-packages\\ipykernel_launcher.py:95: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame\n",
      "\n",
      "See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/indexing.html#indexing-view-versus-copy\n",
      "C:\\Users\\sss83327\\Anaconda3\\lib\\site-packages\\ipykernel_launcher.py:96: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame\n",
      "\n",
      "See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/indexing.html#indexing-view-versus-copy\n"
     ]
    }
   ],
   "source": [
    "start = time.time()\n",
    "\n",
    "#discrete_features_x_train = pd.DataFrame(columns=['protocol_type', 'service', 'flag', 'land', 'logged_in', 'is_host_login', 'is_guest_login'])\n",
    "discrete_features_x_train = pd.DataFrame()\n",
    "\n",
    "encode_text_dummy(df, 'protocol_type', discrete_features_x_train)\n",
    "encode_text_dummy(df, 'service', discrete_features_x_train)\n",
    "encode_text_dummy(df, 'flag', discrete_features_x_train)\n",
    "encode_text_dummy(df, 'land', discrete_features_x_train)\n",
    "encode_text_dummy(df, 'logged_in', discrete_features_x_train)\n",
    "encode_text_dummy(df, 'is_host_login', discrete_features_x_train)\n",
    "encode_text_dummy(df, 'is_guest_login', discrete_features_x_train)\n",
    "\n",
    "encode_numeric_zscore(df, 'duration')\n",
    "encode_numeric_zscore(df, 'src_bytes')\n",
    "encode_numeric_zscore(df, 'dst_bytes')\n",
    "encode_numeric_zscore(df, 'wrong_fragment')\n",
    "encode_numeric_zscore(df, 'urgent')\n",
    "encode_numeric_zscore(df, 'hot')\n",
    "encode_numeric_zscore(df, 'num_failed_logins')\n",
    "encode_numeric_zscore(df, 'num_compromised')\n",
    "encode_numeric_zscore(df, 'root_shell')\n",
    "encode_numeric_zscore(df, 'su_attempted')\n",
    "encode_numeric_zscore(df, 'num_root')\n",
    "encode_numeric_zscore(df, 'num_file_creations')\n",
    "encode_numeric_zscore(df, 'num_shells')\n",
    "encode_numeric_zscore(df, 'num_access_files')\n",
    "encode_numeric_zscore(df, 'num_outbound_cmds')\n",
    "encode_numeric_zscore(df, 'count')\n",
    "encode_numeric_zscore(df, 'srv_count')\n",
    "encode_numeric_zscore(df, 'serror_rate')\n",
    "encode_numeric_zscore(df, 'srv_serror_rate')\n",
    "encode_numeric_zscore(df, 'rerror_rate')\n",
    "encode_numeric_zscore(df, 'srv_rerror_rate')\n",
    "encode_numeric_zscore(df, 'same_srv_rate')\n",
    "encode_numeric_zscore(df, 'diff_srv_rate')\n",
    "encode_numeric_zscore(df, 'srv_diff_host_rate')\n",
    "encode_numeric_zscore(df, 'dst_host_count')\n",
    "encode_numeric_zscore(df, 'dst_host_srv_count')\n",
    "encode_numeric_zscore(df, 'dst_host_same_srv_rate')\n",
    "encode_numeric_zscore(df, 'dst_host_diff_srv_rate')\n",
    "encode_numeric_zscore(df, 'dst_host_same_src_port_rate')\n",
    "encode_numeric_zscore(df, 'dst_host_srv_diff_host_rate')\n",
    "encode_numeric_zscore(df, 'dst_host_serror_rate')\n",
    "encode_numeric_zscore(df, 'dst_host_srv_serror_rate')\n",
    "encode_numeric_zscore(df, 'dst_host_rerror_rate')\n",
    "encode_numeric_zscore(df, 'dst_host_srv_rerror_rate')\n",
    "\n",
    "encode_text_index(df, 'outcome')\n",
    "y_train = df['outcome'].copy()\n",
    "df_all = df.copy()\n",
    "\n",
    "del df['outcome']\n",
    "del df['attack'] # attack field means the times being correctly classified by machine learners\n",
    "continous_features = df.copy()\n",
    "'''\n",
    "df_cols = x_train.pop('service-http_8001')\n",
    "x_train['service-http_8001'] = df_cols\n",
    "df_cols = x_train.pop('service-red_i')\n",
    "x_train['service-red_i'] = df_cols\n",
    "'''\n",
    "print (time.time() - start, \"seconds\")"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## 測試資料集處理"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "C:\\Users\\sss83327\\Anaconda3\\lib\\site-packages\\ipykernel_launcher.py:95: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame\n",
      "\n",
      "See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/indexing.html#indexing-view-versus-copy\n",
      "C:\\Users\\sss83327\\Anaconda3\\lib\\site-packages\\ipykernel_launcher.py:96: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame\n",
      "\n",
      "See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/indexing.html#indexing-view-versus-copy\n"
     ]
    }
   ],
   "source": [
    "path = \"./NSL_KDD-master/\"\n",
    "pd.options.display.max_columns = None # show all column\n",
    "\n",
    "filename_read = os.path.join(path,\"KDDTest+.txt\")\n",
    "filename_read\n",
    "df_test = pd.read_csv(filename_read, header=None)\n",
    "df_test.dropna(inplace=True,axis=1) # For now, just drop NA's (rows with missing values)\n",
    "df_test.columns = [\n",
    "    'duration','protocol_type','service','flag','src_bytes','dst_bytes','land','wrong_fragment','urgent','hot','num_failed_logins',\n",
    "    'logged_in','num_compromised','root_shell','su_attempted','num_root','num_file_creations','num_shells','num_access_files',\n",
    "    'num_outbound_cmds','is_host_login','is_guest_login','count','srv_count','serror_rate','srv_serror_rate','rerror_rate',\n",
    "    'srv_rerror_rate','same_srv_rate','diff_srv_rate','srv_diff_host_rate','dst_host_count','dst_host_srv_count',\n",
    "    'dst_host_same_srv_rate','dst_host_diff_srv_rate','dst_host_same_src_port_rate','dst_host_srv_diff_host_rate',\n",
    "    'dst_host_serror_rate','dst_host_srv_serror_rate','dst_host_rerror_rate','dst_host_srv_rerror_rate',\n",
    "    'outcome','attack'\n",
    "]\n",
    "\n",
    "flag_feature_cluster(df_test)\n",
    "service_feature_cluster(df_test)\n",
    "\n",
    "#discrete_features_x_test = pd.DataFrame(columns=['protocol_type', 'service', 'flag', 'land', 'logged_in', 'is_host_login', 'is_guest_login'])\n",
    "discrete_features_x_test = pd.DataFrame()\n",
    "encode_text_dummy(df_test, 'is_host_login', discrete_features_x_test)\n",
    "encode_text_dummy(df_test, 'is_guest_login', discrete_features_x_test)\n",
    "encode_text_dummy(df_test, 'protocol_type', discrete_features_x_test)\n",
    "encode_text_dummy(df_test, 'service', discrete_features_x_test)\n",
    "encode_text_dummy(df_test, 'flag', discrete_features_x_test)\n",
    "encode_text_dummy(df_test, 'land', discrete_features_x_test)\n",
    "encode_text_dummy(df_test, 'logged_in', discrete_features_x_test)\n",
    "\n",
    "encode_numeric_zscore(df_test, 'duration')\n",
    "encode_numeric_zscore(df_test, 'src_bytes')\n",
    "encode_numeric_zscore(df_test, 'dst_bytes')\n",
    "encode_numeric_zscore(df_test, 'wrong_fragment')\n",
    "encode_numeric_zscore(df_test, 'urgent')\n",
    "encode_numeric_zscore(df_test, 'hot')\n",
    "encode_numeric_zscore(df_test, 'num_failed_logins')\n",
    "encode_numeric_zscore(df_test, 'num_compromised')\n",
    "encode_numeric_zscore(df_test, 'root_shell')\n",
    "encode_numeric_zscore(df_test, 'su_attempted')\n",
    "encode_numeric_zscore(df_test, 'num_root')\n",
    "encode_numeric_zscore(df_test, 'num_file_creations')\n",
    "encode_numeric_zscore(df_test, 'num_shells')\n",
    "encode_numeric_zscore(df_test, 'num_access_files')\n",
    "encode_numeric_zscore(df_test, 'num_outbound_cmds')\n",
    "encode_numeric_zscore(df_test, 'count')\n",
    "encode_numeric_zscore(df_test, 'srv_count')\n",
    "encode_numeric_zscore(df_test, 'serror_rate')\n",
    "encode_numeric_zscore(df_test, 'srv_serror_rate')\n",
    "encode_numeric_zscore(df_test, 'rerror_rate')\n",
    "encode_numeric_zscore(df_test, 'srv_rerror_rate')\n",
    "encode_numeric_zscore(df_test, 'same_srv_rate')\n",
    "encode_numeric_zscore(df_test, 'diff_srv_rate')\n",
    "encode_numeric_zscore(df_test, 'srv_diff_host_rate')\n",
    "encode_numeric_zscore(df_test, 'dst_host_count')\n",
    "encode_numeric_zscore(df_test, 'dst_host_srv_count')\n",
    "encode_numeric_zscore(df_test, 'dst_host_same_srv_rate')\n",
    "encode_numeric_zscore(df_test, 'dst_host_diff_srv_rate')\n",
    "encode_numeric_zscore(df_test, 'dst_host_same_src_port_rate')\n",
    "encode_numeric_zscore(df_test, 'dst_host_srv_diff_host_rate')\n",
    "encode_numeric_zscore(df_test, 'dst_host_serror_rate')\n",
    "encode_numeric_zscore(df_test, 'dst_host_srv_serror_rate')\n",
    "encode_numeric_zscore(df_test, 'dst_host_rerror_rate')\n",
    "encode_numeric_zscore(df_test, 'dst_host_srv_rerror_rate')\n",
    "encode_text_index(df_test, 'outcome')\n",
    "df_test_all = df_test.copy()\n",
    "del df_test['outcome']\n",
    "del df_test['attack'] # attack field means the times being correctly classified by machine learners\n",
    "\n",
    "resort_col = (df_test.columns)\n",
    "df = df.reindex(resort_col, axis=1)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    " ## KDDtest -21 資料集處理"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "C:\\Users\\sss83327\\Anaconda3\\lib\\site-packages\\ipykernel_launcher.py:95: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame\n",
      "\n",
      "See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/indexing.html#indexing-view-versus-copy\n",
      "C:\\Users\\sss83327\\Anaconda3\\lib\\site-packages\\ipykernel_launcher.py:96: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame\n",
      "\n",
      "See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/indexing.html#indexing-view-versus-copy\n"
     ]
    }
   ],
   "source": [
    "path = \"./NSL_KDD-master/\"\n",
    "pd.options.display.max_columns = None # show all column\n",
    "\n",
    "filename_read = os.path.join(path,\"KDDTest-21.txt\")\n",
    "filename_read\n",
    "df_test21 = pd.read_csv(filename_read, header=None)\n",
    "df_test21.dropna(inplace=True,axis=1) # For now, just drop NA's (rows with missing values)\n",
    "df_test21.columns = [\n",
    "    'duration','protocol_type','service','flag','src_bytes','dst_bytes','land','wrong_fragment','urgent','hot','num_failed_logins',\n",
    "    'logged_in','num_compromised','root_shell','su_attempted','num_root','num_file_creations','num_shells','num_access_files',\n",
    "    'num_outbound_cmds','is_host_login','is_guest_login','count','srv_count','serror_rate','srv_serror_rate','rerror_rate',\n",
    "    'srv_rerror_rate','same_srv_rate','diff_srv_rate','srv_diff_host_rate','dst_host_count','dst_host_srv_count',\n",
    "    'dst_host_same_srv_rate','dst_host_diff_srv_rate','dst_host_same_src_port_rate','dst_host_srv_diff_host_rate',\n",
    "    'dst_host_serror_rate','dst_host_srv_serror_rate','dst_host_rerror_rate','dst_host_srv_rerror_rate',\n",
    "    'outcome','attack'\n",
    "]\n",
    "\n",
    "flag_feature_cluster(df_test21)\n",
    "service_feature_cluster(df_test21)\n",
    "\n",
    "#discrete_features_x_test21 = pd.DataFrame(columns=['protocol_type', 'service', 'flag', 'land', 'logged_in', 'is_host_login', 'is_guest_login'])\n",
    "discrete_features_x_test21 = pd.DataFrame()\n",
    "encode_text_dummy(df_test21, 'is_host_login', discrete_features_x_test21)\n",
    "encode_text_dummy(df_test21, 'is_guest_login', discrete_features_x_test21)\n",
    "encode_text_dummy(df_test21, 'protocol_type', discrete_features_x_test21)\n",
    "encode_text_dummy(df_test21, 'service', discrete_features_x_test21)\n",
    "encode_text_dummy(df_test21, 'flag', discrete_features_x_test21)\n",
    "encode_text_dummy(df_test21, 'land', discrete_features_x_test21)\n",
    "encode_text_dummy(df_test21, 'logged_in', discrete_features_x_test21)\n",
    "\n",
    "encode_numeric_zscore(df_test21, 'duration')\n",
    "encode_numeric_zscore(df_test21, 'src_bytes')\n",
    "encode_numeric_zscore(df_test21, 'dst_bytes')\n",
    "encode_numeric_zscore(df_test21, 'wrong_fragment')\n",
    "encode_numeric_zscore(df_test21, 'urgent')\n",
    "encode_numeric_zscore(df_test21, 'hot')\n",
    "encode_numeric_zscore(df_test21, 'num_failed_logins')\n",
    "encode_numeric_zscore(df_test21, 'num_compromised')\n",
    "encode_numeric_zscore(df_test21, 'root_shell')\n",
    "encode_numeric_zscore(df_test21, 'su_attempted')\n",
    "encode_numeric_zscore(df_test21, 'num_root')\n",
    "encode_numeric_zscore(df_test21, 'num_file_creations')\n",
    "encode_numeric_zscore(df_test21, 'num_shells')\n",
    "encode_numeric_zscore(df_test21, 'num_access_files')\n",
    "encode_numeric_zscore(df_test21, 'num_outbound_cmds')\n",
    "encode_numeric_zscore(df_test21, 'count')\n",
    "encode_numeric_zscore(df_test21, 'srv_count')\n",
    "encode_numeric_zscore(df_test21, 'serror_rate')\n",
    "encode_numeric_zscore(df_test21, 'srv_serror_rate')\n",
    "encode_numeric_zscore(df_test21, 'rerror_rate')\n",
    "encode_numeric_zscore(df_test21, 'srv_rerror_rate')\n",
    "encode_numeric_zscore(df_test21, 'same_srv_rate')\n",
    "encode_numeric_zscore(df_test21, 'diff_srv_rate')\n",
    "encode_numeric_zscore(df_test21, 'srv_diff_host_rate')\n",
    "encode_numeric_zscore(df_test21, 'dst_host_count')\n",
    "encode_numeric_zscore(df_test21, 'dst_host_srv_count')\n",
    "encode_numeric_zscore(df_test21, 'dst_host_same_srv_rate')\n",
    "encode_numeric_zscore(df_test21, 'dst_host_diff_srv_rate')\n",
    "encode_numeric_zscore(df_test21, 'dst_host_same_src_port_rate')\n",
    "encode_numeric_zscore(df_test21, 'dst_host_srv_diff_host_rate')\n",
    "encode_numeric_zscore(df_test21, 'dst_host_serror_rate')\n",
    "encode_numeric_zscore(df_test21, 'dst_host_srv_serror_rate')\n",
    "encode_numeric_zscore(df_test21, 'dst_host_rerror_rate')\n",
    "encode_numeric_zscore(df_test21, 'dst_host_srv_rerror_rate')\n",
    "encode_text_index(df_test21, 'outcome')\n",
    "df_test21_all = df_test21.copy()\n",
    "del df_test21['outcome']\n",
    "del df_test21['attack'] # attack field means the times being correctly classified by machine learners\n",
    "\n",
    "#resort_col = (df_test21.columns)\n",
    "df_test21 = df_test21.reindex(resort_col, axis=1)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## WTA神經網路建置"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "metadata": {},
   "outputs": [],
   "source": [
    "import os\n",
    "import time\n",
    "from sklearn import ensemble, metrics\n",
    "from xgboost import XGBClassifier\n",
    "import numpy as np\n",
    "import tensorflow as tf\n",
    "from tensorflow.examples.tutorials.mnist import input_data\n",
    "\n",
    "from models import FullyConnectedWTA\n",
    "from util import plot_dictionary, plot_reconstruction, plot_tsne, svm_acc, timestamp, value_to_summary\n",
    "\n",
    "default_dir_suffix = timestamp()\n",
    "\n",
    "learning_rate = 0.0005   # 0.0001\n",
    "sparsity = 0.5           # 0.5\n",
    "epoches = 178            # 172  178\n",
    "batchsize = 100\n",
    "hidden = 30\n",
    "\n",
    "\n",
    "train_size = 125973\n",
    "\n",
    "\n",
    "tf.app.flags.DEFINE_string('f', '', 'kernel')\n",
    "tf.app.flags.DEFINE_string('data_dir', 'MNIST_data/',\n",
    "                           'where to load data from (or download data to)')\n",
    "tf.app.flags.DEFINE_string('train_dir', 'train_%s' % default_dir_suffix,\n",
    "                           'where to store checkpoints to (or load checkpoints from)')\n",
    "tf.app.flags.DEFINE_string('log_dir', 'log_%s' % default_dir_suffix,\n",
    "                           'where to store logs to (use with --write_logs)')\n",
    "tf.app.flags.DEFINE_float('learning_rate', learning_rate,\n",
    "                          'learning rate to use during training')\n",
    "tf.app.flags.DEFINE_float('sparsity', sparsity,\n",
    "                          'lifetime sparsity constraint to enforce')\n",
    "tf.app.flags.DEFINE_integer('batch_size', batchsize,\n",
    "                            'batch size to use during training')\n",
    "tf.app.flags.DEFINE_integer('hidden_units', hidden,\n",
    "                            'size of each ReLU (encode) layer')\n",
    "tf.app.flags.DEFINE_integer('num_layers', 1,\n",
    "                            'number of ReLU (encode) layers')\n",
    "tf.app.flags.DEFINE_integer('train_steps', int(train_size * epoches / batchsize),\n",
    "                            'total minibatches to train')\n",
    "tf.app.flags.DEFINE_integer('steps_per_display', 1000,\n",
    "                            'minibatches to train before printing loss')\n",
    "tf.app.flags.DEFINE_integer('steps_per_checkpoint', 10000,\n",
    "                            'minibatches to train before saving checkpoint')\n",
    "tf.app.flags.DEFINE_integer('train_size', train_size,\n",
    "                            'number of examples to use to train classifier')\n",
    "tf.app.flags.DEFINE_integer('test_size', 10000,\n",
    "                            'number of examples to use to test classifier')\n",
    "tf.app.flags.DEFINE_boolean('use_seed', True,\n",
    "                            'fix random seed to guarantee reproducibility')\n",
    "tf.app.flags.DEFINE_boolean('write_logs', False,\n",
    "                            'write log files')\n",
    "tf.app.flags.DEFINE_boolean('show_plots', False,\n",
    "                            'show visualizations')\n",
    "FLAGS = tf.app.flags.FLAGS"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "step=1000, global step=1000.0, loss=1604.678, time=0.002\n",
      "step=2000, global step=2000.0, loss=901.990, time=0.002\n",
      "step=3000, global step=3000.0, loss=511.049, time=0.002\n",
      "step=4000, global step=4000.0, loss=609.397, time=0.002\n",
      "step=5000, global step=5000.0, loss=575.677, time=0.002\n",
      "step=6000, global step=6000.0, loss=555.018, time=0.002\n",
      "step=7000, global step=7000.0, loss=482.408, time=0.002\n",
      "step=8000, global step=8000.0, loss=259.868, time=0.002\n",
      "step=9000, global step=9000.0, loss=420.506, time=0.002\n",
      "step=10000, global step=10000.0, loss=361.119, time=0.002\n",
      "step=11000, global step=11000.0, loss=330.003, time=0.002\n",
      "step=12000, global step=12000.0, loss=285.476, time=0.002\n",
      "step=13000, global step=13000.0, loss=153.027, time=0.003\n",
      "step=14000, global step=14000.0, loss=251.487, time=0.002\n",
      "step=15000, global step=15000.0, loss=221.080, time=0.002\n",
      "step=16000, global step=16000.0, loss=201.833, time=0.002\n",
      "step=17000, global step=17000.0, loss=179.280, time=0.002\n",
      "step=18000, global step=18000.0, loss=127.530, time=0.002\n",
      "step=19000, global step=19000.0, loss=161.874, time=0.002\n",
      "step=20000, global step=20000.0, loss=139.696, time=0.002\n",
      "step=21000, global step=21000.0, loss=130.082, time=0.002\n",
      "step=22000, global step=22000.0, loss=106.695, time=0.002\n",
      "step=23000, global step=23000.0, loss=114.633, time=0.002\n",
      "step=24000, global step=24000.0, loss=109.219, time=0.002\n",
      "step=25000, global step=25000.0, loss=99.767, time=0.002\n",
      "step=26000, global step=26000.0, loss=100.051, time=0.002\n",
      "step=27000, global step=27000.0, loss=93.895, time=0.002\n",
      "step=28000, global step=28000.0, loss=97.317, time=0.002\n",
      "step=29000, global step=29000.0, loss=96.470, time=0.002\n",
      "step=30000, global step=30000.0, loss=91.214, time=0.002\n",
      "step=31000, global step=31000.0, loss=92.001, time=0.002\n",
      "step=32000, global step=32000.0, loss=85.671, time=0.002\n",
      "step=33000, global step=33000.0, loss=89.299, time=0.002\n",
      "step=34000, global step=34000.0, loss=87.687, time=0.002\n",
      "step=35000, global step=35000.0, loss=84.788, time=0.002\n",
      "step=36000, global step=36000.0, loss=85.637, time=0.002\n",
      "step=37000, global step=37000.0, loss=79.719, time=0.002\n",
      "step=38000, global step=38000.0, loss=83.775, time=0.002\n",
      "step=39000, global step=39000.0, loss=81.484, time=0.002\n",
      "step=40000, global step=40000.0, loss=79.239, time=0.002\n",
      "step=41000, global step=41000.0, loss=79.757, time=0.002\n",
      "step=42000, global step=42000.0, loss=74.550, time=0.003\n",
      "step=43000, global step=43000.0, loss=78.835, time=0.003\n",
      "step=44000, global step=44000.0, loss=76.902, time=0.003\n",
      "step=45000, global step=45000.0, loss=74.958, time=0.002\n",
      "step=46000, global step=46000.0, loss=75.079, time=0.003\n",
      "step=47000, global step=47000.0, loss=70.438, time=0.002\n",
      "step=48000, global step=48000.0, loss=75.130, time=0.002\n",
      "step=49000, global step=49000.0, loss=72.700, time=0.002\n",
      "step=50000, global step=50000.0, loss=71.489, time=0.002\n",
      "step=51000, global step=51000.0, loss=69.848, time=0.002\n",
      "step=52000, global step=52000.0, loss=70.479, time=0.002\n",
      "step=53000, global step=53000.0, loss=72.013, time=0.002\n",
      "step=54000, global step=54000.0, loss=67.884, time=0.002\n",
      "step=55000, global step=55000.0, loss=70.167, time=0.002\n",
      "step=56000, global step=56000.0, loss=64.624, time=0.002\n",
      "step=57000, global step=57000.0, loss=68.772, time=0.002\n",
      "step=58000, global step=58000.0, loss=68.931, time=0.002\n",
      "step=59000, global step=59000.0, loss=65.005, time=0.002\n",
      "step=60000, global step=60000.0, loss=67.189, time=0.002\n",
      "step=61000, global step=61000.0, loss=61.832, time=0.003\n",
      "step=62000, global step=62000.0, loss=66.005, time=0.002\n",
      "step=63000, global step=63000.0, loss=65.995, time=0.002\n",
      "step=64000, global step=64000.0, loss=62.757, time=0.002\n",
      "step=65000, global step=65000.0, loss=64.929, time=0.002\n",
      "step=66000, global step=66000.0, loss=59.930, time=0.002\n",
      "step=67000, global step=67000.0, loss=63.459, time=0.002\n",
      "step=68000, global step=68000.0, loss=62.774, time=0.002\n",
      "step=69000, global step=69000.0, loss=61.423, time=0.002\n",
      "step=70000, global step=70000.0, loss=62.312, time=0.002\n",
      "step=71000, global step=71000.0, loss=58.026, time=0.002\n",
      "step=72000, global step=72000.0, loss=61.103, time=0.003\n",
      "step=73000, global step=73000.0, loss=60.737, time=0.003\n",
      "step=74000, global step=74000.0, loss=59.318, time=0.003\n",
      "step=75000, global step=75000.0, loss=60.225, time=0.003\n",
      "step=76000, global step=76000.0, loss=56.077, time=0.003\n",
      "step=77000, global step=77000.0, loss=59.563, time=0.003\n",
      "step=78000, global step=78000.0, loss=58.871, time=0.002\n",
      "step=79000, global step=79000.0, loss=57.664, time=0.002\n",
      "step=80000, global step=80000.0, loss=57.999, time=0.002\n",
      "step=81000, global step=81000.0, loss=55.514, time=0.002\n",
      "step=82000, global step=82000.0, loss=58.119, time=0.002\n",
      "step=83000, global step=83000.0, loss=57.112, time=0.003\n",
      "step=84000, global step=84000.0, loss=56.243, time=0.002\n",
      "step=85000, global step=85000.0, loss=55.384, time=0.003\n",
      "step=86000, global step=86000.0, loss=56.106, time=0.003\n",
      "step=87000, global step=87000.0, loss=56.921, time=0.003\n",
      "step=88000, global step=88000.0, loss=54.709, time=0.002\n",
      "step=89000, global step=89000.0, loss=56.277, time=0.002\n",
      "step=90000, global step=90000.0, loss=52.471, time=0.002\n",
      "step=91000, global step=91000.0, loss=55.933, time=0.002\n",
      "step=92000, global step=92000.0, loss=55.662, time=0.002\n",
      "step=93000, global step=93000.0, loss=53.686, time=0.002\n",
      "step=94000, global step=94000.0, loss=54.876, time=0.002\n",
      "step=95000, global step=95000.0, loss=51.140, time=0.002\n",
      "step=96000, global step=96000.0, loss=54.905, time=0.002\n",
      "step=97000, global step=97000.0, loss=54.221, time=0.002\n",
      "step=98000, global step=98000.0, loss=52.883, time=0.002\n",
      "step=99000, global step=99000.0, loss=53.946, time=0.002\n",
      "step=100000, global step=100000.0, loss=50.067, time=0.003\n",
      "step=101000, global step=101000.0, loss=53.974, time=0.003\n",
      "step=102000, global step=102000.0, loss=52.945, time=0.003\n",
      "step=103000, global step=103000.0, loss=52.391, time=0.003\n",
      "step=104000, global step=104000.0, loss=52.656, time=0.002\n",
      "step=105000, global step=105000.0, loss=49.230, time=0.002\n",
      "step=106000, global step=106000.0, loss=53.177, time=0.002\n",
      "step=107000, global step=107000.0, loss=52.200, time=0.002\n",
      "step=108000, global step=108000.0, loss=51.400, time=0.003\n",
      "step=109000, global step=109000.0, loss=51.841, time=0.002\n",
      "step=110000, global step=110000.0, loss=48.573, time=0.002\n",
      "step=111000, global step=111000.0, loss=52.198, time=0.002\n",
      "step=112000, global step=112000.0, loss=50.978, time=0.002\n",
      "step=113000, global step=113000.0, loss=51.230, time=0.002\n",
      "step=114000, global step=114000.0, loss=50.329, time=0.002\n",
      "step=115000, global step=115000.0, loss=48.594, time=0.002\n",
      "step=116000, global step=116000.0, loss=51.611, time=0.002\n",
      "step=117000, global step=117000.0, loss=49.436, time=0.002\n",
      "step=118000, global step=118000.0, loss=51.094, time=0.002\n",
      "step=119000, global step=119000.0, loss=47.044, time=0.002\n",
      "step=120000, global step=120000.0, loss=50.776, time=0.002\n",
      "step=121000, global step=121000.0, loss=51.077, time=0.002\n",
      "step=122000, global step=122000.0, loss=48.992, time=0.002\n",
      "step=123000, global step=123000.0, loss=50.423, time=0.002\n",
      "step=124000, global step=124000.0, loss=46.563, time=0.002\n",
      "step=125000, global step=125000.0, loss=50.055, time=0.002\n",
      "step=126000, global step=126000.0, loss=50.147, time=0.002\n",
      "step=127000, global step=127000.0, loss=48.485, time=0.002\n",
      "step=128000, global step=128000.0, loss=49.799, time=0.002\n",
      "step=129000, global step=129000.0, loss=45.961, time=0.002\n",
      "step=130000, global step=130000.0, loss=49.425, time=0.002\n",
      "step=131000, global step=131000.0, loss=49.179, time=0.002\n",
      "step=132000, global step=132000.0, loss=48.211, time=0.002\n",
      "step=133000, global step=133000.0, loss=49.037, time=0.003\n",
      "step=134000, global step=134000.0, loss=45.407, time=0.002\n",
      "step=135000, global step=135000.0, loss=48.947, time=0.003\n",
      "step=136000, global step=136000.0, loss=48.792, time=0.002\n",
      "step=137000, global step=137000.0, loss=47.729, time=0.003\n",
      "step=138000, global step=138000.0, loss=48.359, time=0.003\n",
      "step=139000, global step=139000.0, loss=45.051, time=0.003\n",
      "step=140000, global step=140000.0, loss=48.177, time=0.003\n",
      "step=141000, global step=141000.0, loss=48.018, time=0.003\n",
      "step=142000, global step=142000.0, loss=47.071, time=0.003\n",
      "step=143000, global step=143000.0, loss=47.456, time=0.003\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "step=144000, global step=144000.0, loss=44.818, time=0.003\n",
      "step=145000, global step=145000.0, loss=47.527, time=0.003\n",
      "step=146000, global step=146000.0, loss=47.009, time=0.003\n",
      "step=147000, global step=147000.0, loss=46.675, time=0.003\n",
      "step=148000, global step=148000.0, loss=45.998, time=0.003\n",
      "step=149000, global step=149000.0, loss=45.722, time=0.003\n",
      "step=150000, global step=150000.0, loss=47.039, time=0.003\n",
      "step=151000, global step=151000.0, loss=45.920, time=0.003\n",
      "step=152000, global step=152000.0, loss=46.493, time=0.003\n",
      "step=153000, global step=153000.0, loss=43.788, time=0.003\n",
      "step=154000, global step=154000.0, loss=47.105, time=0.003\n",
      "step=155000, global step=155000.0, loss=46.725, time=0.003\n",
      "step=156000, global step=156000.0, loss=45.475, time=0.003\n",
      "step=157000, global step=157000.0, loss=46.001, time=0.003\n",
      "step=158000, global step=158000.0, loss=43.380, time=0.003\n",
      "step=159000, global step=159000.0, loss=46.387, time=0.003\n",
      "step=160000, global step=160000.0, loss=46.101, time=0.003\n",
      "step=161000, global step=161000.0, loss=45.052, time=0.003\n",
      "step=162000, global step=162000.0, loss=45.729, time=0.003\n",
      "step=163000, global step=163000.0, loss=43.162, time=0.003\n",
      "step=164000, global step=164000.0, loss=46.101, time=0.003\n",
      "step=165000, global step=165000.0, loss=45.206, time=0.003\n",
      "step=166000, global step=166000.0, loss=45.254, time=0.003\n",
      "step=167000, global step=167000.0, loss=45.138, time=0.003\n",
      "step=168000, global step=168000.0, loss=42.903, time=0.003\n",
      "step=169000, global step=169000.0, loss=45.847, time=0.003\n",
      "step=170000, global step=170000.0, loss=44.910, time=0.003\n",
      "step=171000, global step=171000.0, loss=44.955, time=0.003\n",
      "step=172000, global step=172000.0, loss=44.692, time=0.003\n",
      "step=173000, global step=173000.0, loss=42.582, time=0.003\n",
      "step=174000, global step=174000.0, loss=45.568, time=0.003\n",
      "step=175000, global step=175000.0, loss=44.591, time=0.003\n",
      "step=176000, global step=176000.0, loss=44.675, time=0.003\n",
      "step=177000, global step=177000.0, loss=44.102, time=0.003\n",
      "step=178000, global step=178000.0, loss=42.780, time=0.003\n",
      "step=179000, global step=179000.0, loss=45.170, time=0.003\n",
      "step=180000, global step=180000.0, loss=43.976, time=0.003\n",
      "step=181000, global step=181000.0, loss=44.282, time=0.003\n",
      "step=182000, global step=182000.0, loss=43.344, time=0.003\n",
      "step=183000, global step=183000.0, loss=43.273, time=0.003\n",
      "step=184000, global step=184000.0, loss=44.811, time=0.003\n",
      "step=185000, global step=185000.0, loss=43.408, time=0.003\n",
      "step=186000, global step=186000.0, loss=44.289, time=0.003\n",
      "step=187000, global step=187000.0, loss=41.926, time=0.003\n",
      "step=188000, global step=188000.0, loss=44.098, time=0.002\n",
      "step=189000, global step=189000.0, loss=44.495, time=0.003\n",
      "step=190000, global step=190000.0, loss=43.277, time=0.003\n",
      "step=191000, global step=191000.0, loss=44.045, time=0.003\n",
      "step=192000, global step=192000.0, loss=41.699, time=0.003\n",
      "step=193000, global step=193000.0, loss=43.932, time=0.003\n",
      "step=194000, global step=194000.0, loss=44.080, time=0.003\n",
      "step=195000, global step=195000.0, loss=43.092, time=0.003\n",
      "step=196000, global step=196000.0, loss=43.712, time=0.003\n",
      "step=197000, global step=197000.0, loss=41.450, time=0.003\n",
      "step=198000, global step=198000.0, loss=43.534, time=0.003\n",
      "step=199000, global step=199000.0, loss=43.415, time=0.003\n",
      "step=200000, global step=200000.0, loss=43.250, time=0.003\n",
      "step=201000, global step=201000.0, loss=43.394, time=0.003\n",
      "step=202000, global step=202000.0, loss=41.342, time=0.003\n",
      "step=203000, global step=203000.0, loss=43.245, time=0.003\n",
      "step=204000, global step=204000.0, loss=43.285, time=0.003\n",
      "step=205000, global step=205000.0, loss=42.966, time=0.003\n",
      "step=206000, global step=206000.0, loss=43.121, time=0.003\n",
      "step=207000, global step=207000.0, loss=41.370, time=0.003\n",
      "step=208000, global step=208000.0, loss=43.017, time=0.003\n",
      "step=209000, global step=209000.0, loss=42.947, time=0.003\n",
      "step=210000, global step=210000.0, loss=42.940, time=0.002\n",
      "step=211000, global step=211000.0, loss=42.743, time=0.003\n",
      "step=212000, global step=212000.0, loss=41.501, time=0.003\n",
      "step=213000, global step=213000.0, loss=42.939, time=0.003\n",
      "step=214000, global step=214000.0, loss=42.543, time=0.003\n",
      "step=215000, global step=215000.0, loss=42.742, time=0.003\n",
      "step=216000, global step=216000.0, loss=40.847, time=0.003\n",
      "C=10.0000, acc=0.7554, train_acc=0.9487\n",
      "Learning rate: 0.0005\n",
      "Sparsity: 0.5\n",
      "Epoches: 172,178\n",
      "Batch size: 100\n",
      "Hidden units: 30\n",
      "Total time is 10.1219 seconds\n",
      "\n",
      "Average accuracy is 0.7554\n",
      "\n",
      "\n",
      "step=217000, global step=217000.0, loss=43.356, time=0.003\n",
      "step=218000, global step=218000.0, loss=42.761, time=0.003\n",
      "step=219000, global step=219000.0, loss=42.420, time=0.003\n",
      "step=220000, global step=220000.0, loss=42.413, time=0.003\n",
      "step=221000, global step=221000.0, loss=40.862, time=0.003\n",
      "step=222000, global step=222000.0, loss=43.133, time=0.003\n",
      "step=223000, global step=223000.0, loss=42.493, time=0.003\n",
      "step=224000, global step=224000.0, loss=42.315, time=0.003\n",
      "C=10.0000, acc=0.7555, train_acc=0.9489\n",
      "Learning rate: 0.0005\n",
      "Sparsity: 0.5\n",
      "Epoches: 178,178\n",
      "Batch size: 100\n",
      "Hidden units: 30\n",
      "Total time is 8.3596 seconds\n",
      "\n",
      "Average accuracy is 0.7555\n",
      "\n",
      "\n",
      "total time is 583.7373261451721 seconds in 224231 steps\n",
      "\n",
      "\n"
     ]
    }
   ],
   "source": [
    "x_train = df.copy()  ## All features\n",
    "x_train.dropna(inplace=True,axis=1) # For now, just drop NA's (rows with missing values)\n",
    "\n",
    "from sklearn.datasets import load_digits\n",
    "from sklearn.svm import SVC\n",
    "from sklearn.preprocessing import StandardScaler\n",
    "from sklearn.svm import LinearSVC\n",
    "from sklearn.metrics import confusion_matrix\n",
    "\n",
    "import time\n",
    "\n",
    "svm_result = pd.DataFrame(columns=['Epochs', 'C', 'Accuracy', 'accuracy_test21', 'Train_accuracy', 'Precision', 'Recall', 'F-score', 'TPR', 'FPR',\n",
    "                                  'tn', 'fp', 'fn', 'tp'])\n",
    "\n",
    "\n",
    "for times in range(1):\n",
    "   \n",
    "    fcwta = FullyConnectedWTA(x_train.shape[1],\n",
    "                            FLAGS.batch_size,\n",
    "                            sparsity=FLAGS.sparsity,\n",
    "                            hidden_units=FLAGS.hidden_units,\n",
    "                            encode_layers=FLAGS.num_layers,\n",
    "                            learning_rate=FLAGS.learning_rate)\n",
    "\n",
    "    start1 = time.time()\n",
    "    \n",
    "    \n",
    "    \n",
    "    train_index = 0\n",
    "    step = 0\n",
    "    avg_time = avg_loss = 0 \n",
    "    \n",
    "    t_cur_time = time.strftime(\"WTA_21%Y-%m-%d %H-%M-%S\", time.localtime()) + \".txt\"\n",
    "    os.mkdir(t_cur_time)\n",
    "    cur_time = t_cur_time + \".txt\"\n",
    "    tt_cur_time = './' + t_cur_time + '/' + cur_time\n",
    "    text_file = open((tt_cur_time), \"w\")\n",
    "    \n",
    "    with tf.Session() as sess:\n",
    "        sess.run(tf.global_variables_initializer())\n",
    "        while step < FLAGS.train_steps:\n",
    "\n",
    "            start_time = time.time()\n",
    "            #batch_x, _ = mnist.train.next_batch(FLAGS.batch_size)\n",
    "            #batch_x = x_train[train_index:train_index+FLAGS.batch_size]\n",
    "            occur = 0\n",
    "            if ( train_index + FLAGS.batch_size > x_train.shape[0]):\n",
    "                batch_x = x_train[train_index:x_train.shape[0]]\n",
    "                _ = train_index + FLAGS.batch_size - x_train.shape[0]\n",
    "                temp = x_train[0: _ ]\n",
    "                batch_x = pd.concat([batch_x, temp])\n",
    "                train_index = _ \n",
    "                occur = 1\n",
    "            else:\n",
    "                batch_x = x_train[train_index:train_index+FLAGS.batch_size]\n",
    "                occur = 0\n",
    "            if (occur == 0):\n",
    "                if( train_index + FLAGS.batch_size == x_train.shape[0]):\n",
    "                    train_index = 0\n",
    "                else:\n",
    "                    train_index += FLAGS.batch_size\n",
    "\n",
    "\n",
    "            _, loss = fcwta.step(sess, batch_x)\n",
    "            \n",
    "\n",
    "            avg_time += (time.time() - start_time) / FLAGS.steps_per_display\n",
    "            avg_loss += loss / FLAGS.steps_per_display\n",
    "            step += 1\n",
    "            if step % FLAGS.steps_per_display == 0:\n",
    "                global_step = fcwta.global_step.eval()\n",
    "                print('step={}, global step={}, loss={:.3f}, time={:.3f}'.format(\n",
    "                    step, global_step, avg_loss, avg_time))\n",
    "                avg_time = avg_loss = 0\n",
    "            \n",
    "\n",
    "            if ((step % 1259 == 0) & ((step == 1259 * epoches) | (step == 1259 * 172)) ):\n",
    "\n",
    "                resort_col = (discrete_features_x_test.columns)\n",
    "                discrete_features_x_train = discrete_features_x_train.reindex(resort_col, axis=1)\n",
    "                \n",
    "                x_test21 = df_test21.copy()\n",
    "                x_test21.dropna(inplace=True,axis=1) # For now, just drop NA's (rows with missing values)\n",
    "                y_test21 = df_test21_all['outcome']\n",
    "                y_test21 = y_test21.astype('int')\n",
    "                \n",
    "                x_test = df_test.copy()\n",
    "                x_test.dropna(inplace=True,axis=1) # For now, just drop NA's (rows with missing values)\n",
    "                y_test = df_test_all['outcome']\n",
    "                y_test = y_test.astype('int')\n",
    "                y_train = df_all['outcome']\n",
    "                y_train = y_train.astype('int')               \n",
    "                \n",
    "                encoded_x_train = fcwta.encode(sess, x_train)\n",
    "                encoded_x_test = fcwta.encode(sess, x_test)             \n",
    "                encoded_x_test21 = fcwta.encode(sess, x_test21)              \n",
    "\n",
    "                encoded_x_train = pd.DataFrame(data=encoded_x_train)\n",
    "                encoded_x_test =  pd.DataFrame(data=encoded_x_test)   \n",
    "                encoded_x_test21 =  pd.DataFrame(data=encoded_x_test21)\n",
    "\n",
    "                for i in range((hidden)):\n",
    "                    encode_numeric_maxmin(encoded_x_train,i)\n",
    "                    encode_numeric_maxmin(encoded_x_test,i)\n",
    "                    encode_numeric_maxmin(encoded_x_test21,i)\n",
    "\n",
    "                merged_x_train = encoded_x_train\n",
    "                merged_x_test = encoded_x_test\n",
    "                merged_x_test21 = encoded_x_test21\n",
    "\n",
    "                totall = 0\n",
    "                start = time.time()\n",
    "\n",
    "\n",
    "                #dict_C = [0.001,0.002,0.003,0.004,0.005, 0.007, 0.008, 0.009, 0.01, 0.015, 0.02, 0.03, 0.04, 0.05, 0.1, 0.5, \n",
    "                #          1,2,3,10,20,30,40,50,70,90,100,200,500,1000] \n",
    "\n",
    "                dict_C = [10] \n",
    "\n",
    "                round_loop = 1\n",
    "                for i in range(round_loop):\n",
    "                    for paramerter_C in dict_C:\n",
    "                        \n",
    "                        lsvc = LinearSVC(C=paramerter_C)\n",
    "                        lsvc.fit(merged_x_train, y_train)\n",
    "                        \n",
    "                        ## ---------------RF-------------------------------------------------\n",
    "                        #lsvc = ensemble.RandomForestClassifier(n_estimators = paramerter_C)\n",
    "                        #lsvc.fit(merged_x_train, y_train)\n",
    "                        ## ---------------RF-------------------------------------------------\n",
    "                        \n",
    "                        ## ---------------XGBoost-------------------------------------------------\n",
    "                        #lsvc = XGBClassifier(n_estimators=paramerter_C)\n",
    "                        #lsvc.fit(merged_x_train, y_train)\n",
    "                        ## ---------------XGBoost-------------------------------------------------\n",
    "                        \n",
    "                        \n",
    "                        accuracy_train = lsvc.score(merged_x_train, y_train) \n",
    "                        accuracy_test21 = lsvc.score(merged_x_test21, y_test21)\n",
    "                        predicted_y = lsvc.predict(merged_x_test)           \n",
    "                        tn, fp, fn, tp = confusion_matrix(y_test, predicted_y).ravel()                    \n",
    "                        precision_score = tp / (tp + fp)\n",
    "                        recall_score = tp / (tp + fn)\n",
    "                        F_score = 2*(precision_score  * recall_score) / (precision_score + recall_score)\n",
    "                        TPR = tp / (tp + fn)\n",
    "                        FPR = fp / (fp + tn)\n",
    "                        accuracy = (tp + tn) / (tn + fp + fn + tp)\n",
    "                        #print (precision_score, recall_score,F_score, TPR, FPR,  accuracy)\n",
    "\n",
    "                        print('C={:.4f}, acc={:.4f}, train_acc={:.4f}'.format(paramerter_C, accuracy, accuracy_train))\n",
    "                        totall += accuracy\n",
    "                        text_file.write('C={:.4f}, acc={:.4f}, train_acc={:.4f}\\n'.format(paramerter_C, accuracy, accuracy_train))\n",
    "                        \n",
    "                        s = pd.Series({'Epochs':int(step/1259), 'C':paramerter_C, 'Accuracy':accuracy, 'accuracy_test21':accuracy_test21,\n",
    "                                       'Train_accuracy':accuracy_train,\n",
    "                                        'Precision':precision_score, 'Recall':recall_score, 'F-score':F_score, 'TPR':TPR, 'FPR':FPR,\n",
    "                                        'tn':tn, 'fp':fp, 'fn':fn, 'tp':tp})\n",
    "                        svm_result = svm_result.append(s, ignore_index=True)\n",
    "                        \n",
    "                        \n",
    "                print (\"Learning rate: {0}\\nSparsity: {1}\\nEpoches: {2},{5}\\nBatch size: {3}\\nHidden units: {4}\".format(learning_rate,sparsity,int(step/1257),batchsize,hidden,epoches))    \n",
    "                print (\"Total time is {0:.4f} seconds\\n\".format(time.time()-start))  \n",
    "                print (\"Average accuracy is {0:.4f}\\n\\n\".format(totall/len(dict_C)/round_loop) )\n",
    "                text_file.write(\"Learning rate: {0}\\nSparsity: {1}\\nEpoches: {2},{5}\\nBatch size: {3}\\nHidden units: {4}\\n\".format(learning_rate,sparsity,int(step/1257),batchsize,hidden,epoches))    \n",
    "                text_file.write(\"Total time is {0:.4f} seconds\\n\\n\".format(time.time()-start))   \n",
    "                text_file.write(\"Average accuracy is {0:.4f}\\n\\n\".format(totall/len(dict_C)/round_loop))  \n",
    "        checkpoint_path = t_cur_time + '/ckpt'\n",
    "        fcwta.saver.save(sess, checkpoint_path) \n",
    "\n",
    "    print (\"total time is {0} seconds in {1} steps\\n\\n\".format(time.time()-start1, step))\n",
    "    text_file.write(\"total time is {0} seconds in {1} steps\\n\\n\".format(time.time()-start1, step))\n",
    "    \n",
    "    cur_time = t_cur_time + \".csv\"\n",
    "    tt_cur_time = './' + t_cur_time + '/' + cur_time\n",
    "    svm_result.to_csv(tt_cur_time, index=0, header=1)\n",
    "    \n",
    "    text_file.close() \n",
    "    tf.reset_default_graph()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Epochs</th>\n",
       "      <th>C</th>\n",
       "      <th>Accuracy</th>\n",
       "      <th>accuracy_test21</th>\n",
       "      <th>Train_accuracy</th>\n",
       "      <th>Precision</th>\n",
       "      <th>Recall</th>\n",
       "      <th>F-score</th>\n",
       "      <th>TPR</th>\n",
       "      <th>FPR</th>\n",
       "      <th>tn</th>\n",
       "      <th>fp</th>\n",
       "      <th>fn</th>\n",
       "      <th>tp</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>172.0</td>\n",
       "      <td>10.0</td>\n",
       "      <td>0.755412</td>\n",
       "      <td>0.539662</td>\n",
       "      <td>0.948735</td>\n",
       "      <td>0.917037</td>\n",
       "      <td>0.627055</td>\n",
       "      <td>0.744817</td>\n",
       "      <td>0.627055</td>\n",
       "      <td>0.074967</td>\n",
       "      <td>8983.0</td>\n",
       "      <td>728.0</td>\n",
       "      <td>4786.0</td>\n",
       "      <td>8047.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>178.0</td>\n",
       "      <td>10.0</td>\n",
       "      <td>0.755500</td>\n",
       "      <td>0.542278</td>\n",
       "      <td>0.948949</td>\n",
       "      <td>0.916487</td>\n",
       "      <td>0.627679</td>\n",
       "      <td>0.745074</td>\n",
       "      <td>0.627679</td>\n",
       "      <td>0.075584</td>\n",
       "      <td>8977.0</td>\n",
       "      <td>734.0</td>\n",
       "      <td>4778.0</td>\n",
       "      <td>8055.0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   Epochs     C  Accuracy  accuracy_test21  Train_accuracy  Precision  \\\n",
       "0   172.0  10.0  0.755412         0.539662        0.948735   0.917037   \n",
       "1   178.0  10.0  0.755500         0.542278        0.948949   0.916487   \n",
       "\n",
       "     Recall   F-score       TPR       FPR      tn     fp      fn      tp  \n",
       "0  0.627055  0.744817  0.627055  0.074967  8983.0  728.0  4786.0  8047.0  \n",
       "1  0.627679  0.745074  0.627679  0.075584  8977.0  734.0  4778.0  8055.0  "
      ]
     },
     "execution_count": 9,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#svm_result[svm_result['Accuracy'] == svm_result['Accuracy'].max()]\n",
    "svm_result"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## 折線圖"
   ]
  },
  {
   "cell_type": "raw",
   "metadata": {
    "scrolled": true
   },
   "source": [
    "\n",
    "i = 1\n",
    "for draw_C in dict_C:\n",
    "    temps = svm_result[['C','Accuracy'] ]\n",
    "    temp = temps[temps['C'] == draw_C]\n",
    "    fig = plt.figure(figsize=(20, 10))\n",
    "    plt.xlim(0,epoches)\n",
    "    plt.ylim(temps['Accuracy'].min(), temps['Accuracy'].max()+0.01)\n",
    "    x = [j for j in range(1, epoches+1)]\n",
    "    y = temp['Accuracy'][:epoches]\n",
    "    plt.title('C={}'.format(draw_C))\n",
    "    plt.xlabel('Epochs')\n",
    "    plt.ylabel('Accuracy')\n",
    "    plt.plot(x, y ,'-', marker='o', color='blue', label='Square')\n",
    "    \n",
    "    cur_time = t_cur_time + \".csv\"\n",
    "    tt_cur_time = './' + t_cur_time + '/'\n",
    "    \n",
    "    plt.savefig(fname='{}Accuracy i={}'.format(tt_cur_time, i))\n",
    "    i += 1"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## 訓練SVM前處理(Encode、Merge)"
   ]
  },
  {
   "cell_type": "raw",
   "metadata": {},
   "source": [
    "resort_col = sorted(discrete_features_x_train.columns)\n",
    "discrete_features_x_test = discrete_features_x_test.reindex(resort_col, axis=1)\n",
    "\n",
    "x_test = df_test.copy()\n",
    "x_test.dropna(inplace=True,axis=1) # For now, just drop NA's (rows with missing values)\n",
    "\n",
    "y_test = df_test_all['outcome']\n",
    "y_test = y_test.astype('int')\n",
    "\n",
    "y_train = df_all['outcome']\n",
    "y_train = y_train.astype('int')\n",
    "\n",
    "merged_x_train = np.hstack((discrete_features_x_train, encoded_x_train))\n",
    "merged_x_test = np.hstack((discrete_features_x_test, encoded_x_test))\n",
    "\n",
    "\n",
    "with tf.Session() as sess:\n",
    "    sess.run(tf.global_variables_initializer())\n",
    "    encoded_x_train = fcwta.encode(sess, x_train)\n",
    "    encoded_x_test = fcwta.encode(sess, x_test)\n",
    "\n",
    "\n",
    "\n",
    "    merged_x_train = np.hstack((discrete_features_x_train, encoded_x_train))\n",
    "merged_x_test = np.hstack((discrete_features_x_test, encoded_x_test))\n"
   ]
  },
  {
   "cell_type": "raw",
   "metadata": {},
   "source": [
    "%matplotlib inline\n",
    "import matplotlib.pyplot as plt\n",
    "pdencode = pd.DataFrame(data=encoded_x_train)\n",
    "#plt.hist(pdencode)\n",
    "pmean = []\n",
    "pmax = []\n",
    "pmin = []\n",
    "for i in range((50)):\n",
    "    pmean.append(pdencode[i].mean())\n",
    "    pmax.append(pdencode[i].max())\n",
    "    pmin.append(pdencode[i].min())\n",
    "plt.hist(pmax, bins=50,color='SteelBlue', edgecolor=\"LightSteelBlue\")\n",
    "plt.title('Maximum value in hidden layer')\n",
    "#plt.savefig(fname='max')"
   ]
  },
  {
   "cell_type": "raw",
   "metadata": {},
   "source": [
    "plt.hist(pmean, bins=50,color='SteelBlue', edgecolor=\"LightSteelBlue\")\n",
    "plt.title('Mean value in hidden layer')\n",
    "#plt.savefig(fname='mean')"
   ]
  },
  {
   "cell_type": "raw",
   "metadata": {},
   "source": [
    "plt.hist(pmin, bins=20,color='SteelBlue', edgecolor=\"LightSteelBlue\")\n",
    "plt.title('Minimum value in hidden layer')\n",
    "plt.savefig(fname='min')"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Linear SVM: 經過Encoder"
   ]
  },
  {
   "cell_type": "raw",
   "metadata": {
    "collapsed": true
   },
   "source": [
    "from sklearn.datasets import load_digits\n",
    "from sklearn.svm import SVC\n",
    "from sklearn.preprocessing import StandardScaler\n",
    "from sklearn.svm import LinearSVC\n",
    "import time\n",
    "\n",
    "\n",
    "with tf.Session() as sess:\n",
    "    sess.run(tf.global_variables_initializer())\n",
    "    encoded_x_train = fcwta.encode(sess, x_train)\n",
    "    encoded_x_test = fcwta.encode(sess, x_test)\n",
    "\n",
    "\n",
    "merged_x_train = encoded_x_train\n",
    "merged_x_test = encoded_x_test\n",
    "\n",
    "\n",
    "\n",
    "totall = 0\n",
    "start = time.time()\n",
    "cur_time = time.strftime(\"All_features_to_WTAencoder%Y-%m-%d %H-%M\", time.localtime()) + \".txt\"     \n",
    "text_file = open((cur_time), \"w\")\n",
    "\n",
    "dict_C = [0.001,0.002,0.003,0.004,0.005, 0.007, 0.008, 0.009, 0.01, 0.015, 0.02, 0.03, 0.04, 0.05, 0.1, 0.5, \n",
    "          1,2,3,10,20,30,40,50,70,90,100,200,500,1000] \n",
    "round_loop = 1\n",
    "for i in range(round_loop):\n",
    "    for paramerter_C in dict_C:\n",
    "        lsvc = LinearSVC(C=paramerter_C)\n",
    "        lsvc.fit(merged_x_train, y_train)\n",
    "        #acc, con = svm_acc(encoded_x_train, y_train, encoded_x_test, y_test, C)\n",
    "        #print (time.time() - start)\n",
    "        \n",
    "        traintest = lsvc.score(merged_x_train, y_train)\n",
    "        print('C={:.4f}, acc={:.4f}, train_acc={:.4f}'.format(paramerter_C, lsvc.score(merged_x_test, y_test), traintest))\n",
    "        totall += lsvc.score(merged_x_test, y_test)\n",
    "        text_file.write('C={:.4f}, acc={:.4f}, train_acc={:.4f}\\n'.format(paramerter_C, lsvc.score(merged_x_test, y_test), traintest))\n",
    "\n",
    "print (\"Learning rate: {0}\\nSparsity: {1}\\nEpoches: {2}\\nBatch size: {3}\\nHidden units: {4}\".format(learning_rate,sparsity,epoches,batchsize,hidden))    \n",
    "print (\"Total time is {0:.4f} seconds\\n\".format(time.time()-start))  \n",
    "print (\"Average accuracy is {0:.4f}\".format(totall/len(dict_C)/round_loop) )\n",
    "text_file.write(\"Learning rate: {0}\\nSparsity: {1}\\nEpoches: {2}\\nBatch size: {3}\\nHidden units: {4}\\n\".format(learning_rate,sparsity,epoches,batchsize,hidden))    \n",
    "text_file.write(\"Total time is {0:.4f} seconds\\n\\n\".format(time.time()-start))   \n",
    "text_file.write(\"Average accuracy is {0:.4f}\".format(totall/len(dict_C)/round_loop))    \n",
    "\n",
    "text_file.close()    "
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Linear SVM: 未經過Encoder"
   ]
  },
  {
   "cell_type": "raw",
   "metadata": {},
   "source": [
    "from sklearn.datasets import load_digits\n",
    "from sklearn.preprocessing import StandardScaler\n",
    "from sklearn.svm import LinearSVC\n",
    "\n",
    "merged_x_train = np.hstack((discrete_features_x_train, x_train))\n",
    "merged_x_test = np.hstack((discrete_features_x_test, x_test))\n",
    "\n",
    "\n",
    "totall = 0\n",
    "start = time.time()\n",
    "cur_time = time.strftime(\"no-encoder%Y-%m-%d %H-%M\", time.localtime()) + \".txt\"     \n",
    "text_file = open((cur_time), \"w\")\n",
    "\n",
    "dict_C = [0.001,0.002,0.003,0.004,0.005, 0.007, 0.008, 0.009, 0.01, 0.015, 0.02, 0.03, 0.04, 0.05, 0.1, 0.5, \n",
    "          1,2,3,10,20,30,40,50,70,90,100,200,500,1000] \n",
    "round_loop = 10\n",
    "for i in range(round_loop):\n",
    "    for paramerter_C in dict_C:\n",
    "        lsvc = LinearSVC(C=paramerter_C)\n",
    "        lsvc.fit(merged_x_train, y_train)\n",
    "        #acc, con = svm_acc(encoded_x_train, y_train, encoded_x_test, y_test, C)\n",
    "        #print (time.time() - start)\n",
    "        \n",
    "        traintest = lsvc.score(merged_x_train, y_train)\n",
    "        print('C={:.4f}, acc={:.4f}, train_acc={:.4f}'.format(paramerter_C, lsvc.score(merged_x_test, y_test), traintest))\n",
    "        totall += lsvc.score(merged_x_test, y_test)\n",
    "        text_file.write('C={:.3f}, acc={:.4f}, train_acc={:.4f}\\n'.format(paramerter_C, lsvc.score(merged_x_test, y_test), traintest))\n",
    "\n",
    "    \n",
    "print (\"Learning rate: {0}\\nSparsity: {1}\\nEpoches: {2}\\nBatch size: {3}\\nHidden units: {4}\".format(learning_rate,sparsity,epoches,batchsize,hidden))    \n",
    "print (\"Total time is {0:.4f} seconds\\n\".format(time.time()-start))  \n",
    "print (\"Average accuracy is {0:.4f}\".format(totall/len(dict_C)/round_loop) )\n",
    "text_file.write(\"Learning rate: {0}\\nSparsity: {1}\\nEpoches: {2}\\nBatch size: {3}\\nHidden units: {4}\\n\".format(learning_rate,sparsity,epoches,batchsize,hidden))    \n",
    "text_file.write(\"Total time is {0:.4f} seconds\\n\\n\".format(time.time()-start))   \n",
    "text_file.write(\"Average accuracy is {0:.4f}\".format(totall/len(dict_C)/round_loop))   \n",
    "\n",
    "text_file.close()    "
   ]
  },
  {
   "cell_type": "raw",
   "metadata": {},
   "source": [
    "with open('test.pickle', 'rb') as f:\n",
    "    clf = pickle.load(f)"
   ]
  },
  {
   "cell_type": "raw",
   "metadata": {},
   "source": [
    "import pickle #pickle模块\n",
    "with open('test.pickle', 'wb') as f:\n",
    "    pickle.dump(lsvc, f)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## AE神經網路建置、訓練"
   ]
  },
  {
   "cell_type": "raw",
   "metadata": {},
   "source": [
    "resort_col = (discrete_features_x_train.columns)\n",
    "discrete_features_x_test = discrete_features_x_test.reindex(resort_col, axis=1)\n",
    "\n",
    "\n",
    "\n",
    "x_test = df_test.copy()\n",
    "x_test.dropna(inplace=True,axis=1) # For now, just drop NA's (rows with missing values)\n",
    "\n",
    "y_test = df_test_all['outcome']\n",
    "y_test = y_test.astype('int')\n",
    "\n",
    "y_train = df_all['outcome']\n",
    "y_train = y_train.astype('int')\n",
    "x_train = df.copy()\n",
    "x_train.dropna(inplace=True,axis=1) # For now, just drop NA's (rows with missing values)\n",
    "\n",
    "\n",
    "x_train = np.hstack((discrete_features_x_train, x_train))\n",
    "x_test = np.hstack((discrete_features_x_test, x_test))\n",
    "\n",
    "\n",
    "\n",
    "# this is our input placeholder\n",
    "num_features = x_train.shape[1]\n",
    "input_data = Input(shape=(num_features,))\n",
    "encoding_dim = 20\n",
    "\n",
    "# encoder layers\n",
    "#encoded = Dense(50, activation='relu')(input_data)\n",
    "#encoded = Dense(20, activation='relu')(encoded)\n",
    "encoder_output = Dense(encoding_dim, activation='relu')(input_data)\n",
    "\n",
    "# decoder layers\n",
    "#decoded = Dense(20, activation='relu')(encoder_output)\n",
    "#decoded = Dense(50, activation='relu')(decoded)\n",
    "decoded = Dense(num_features, activation='linear')(encoder_output)\n",
    "\n",
    "# construct the autoencoder model\n",
    "autoencoder = Model(input=input_data, output=decoded)\n",
    "\n",
    "# construct the encoder model for plotting\n",
    "encoder = Model(input=input_data, output=encoder_output)\n",
    "\n",
    "# compile autoencoder\n",
    "autoencoder.compile(optimizer='adam', loss='mse')\n",
    "\n",
    "epoches = 30\n",
    "batchsize = 100\n",
    "hidden = encoding_dim\n",
    "# training\n",
    "autoencoder.fit(x_train, x_train,\n",
    "                batch_size=batchsize,\n",
    "                epochs=epoches )"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Linear SVM: 經過General Encoder"
   ]
  },
  {
   "cell_type": "raw",
   "metadata": {},
   "source": [
    "from sklearn.datasets import load_digits\n",
    "from sklearn.svm import SVC\n",
    "from sklearn.preprocessing import StandardScaler\n",
    "from sklearn.svm import LinearSVC\n",
    "import time\n",
    "\n",
    "merged_x_train = encoder.predict(x_train)\n",
    "merged_x_test = encoder.predict(x_test)\n",
    "\n",
    "\n",
    "totall = 0\n",
    "start = time.time()\n",
    "cur_time = time.strftime(\"AE%Y-%m-%d %H-%M\", time.localtime()) + \".txt\"     \n",
    "text_file = open((cur_time), \"w\")\n",
    "\n",
    "dict_C = [0.001,0.002,0.003,0.004,0.005, 0.007, 0.008, 0.009, 0.01, 0.015, 0.02, 0.03, 0.04, 0.05, 0.1, 0.5, \n",
    "          1,2,3,10,100,1000] \n",
    "round_loop = 1\n",
    "for i in range(round_loop):\n",
    "    for paramerter_C in dict_C:\n",
    "        lsvc = LinearSVC(C=paramerter_C)\n",
    "        lsvc.fit(merged_x_train, y_train)\n",
    "        #acc, con = svm_acc(encoded_x_train, y_train, encoded_x_test, y_test, C)\n",
    "        #print (time.time() - start)\n",
    "        \n",
    "        traintest = lsvc.score(merged_x_train, y_train)\n",
    "        print('C={:.4f}, acc={:.4f}, train_acc={:.4f}'.format(paramerter_C, lsvc.score(merged_x_test, y_test), traintest))\n",
    "        totall += lsvc.score(merged_x_test, y_test)\n",
    "        text_file.write('C={:.4f}, acc={:.4f}, train_acc={:.4f}\\n'.format(paramerter_C, lsvc.score(merged_x_test, y_test), traintest))\n",
    "\n",
    "print (\"Epoches: {0}\\nBatch size: {1}\\nHidden units: {2}\".format(epoches,batchsize,hidden))    \n",
    "print (\"Total time is {0:.4f} seconds\\n\".format(time.time()-start))  \n",
    "print (\"Average accuracy is {0:.4f}\".format(totall/len(dict_C)/round_loop) )\n",
    "text_file.write(\"Epoches: {0}\\nBatch size: {1}\\nHidden units: {2}\".format(epoches,batchsize,hidden))   \n",
    "text_file.write(\"Total time is {0:.4f} seconds\\n\\n\".format(time.time()-start))   \n",
    "text_file.write(\"Average accuracy is {0:.4f}\".format(totall/len(dict_C)/round_loop))    \n",
    "\n",
    "text_file.close()    "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.6.4"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 2
}
